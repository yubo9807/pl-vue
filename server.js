"use strict";var ft=Object.defineProperty;var pt=(t,e,n)=>e in t?ft(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var a=(t,e,n)=>(pt(t,typeof e!="symbol"?e+"":e,n),n);const ht=require("http"),G=require("fs"),k=require("path");function $(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function f(t){return["object","array"].includes($(t))}function dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function J(t,e){if(f(t)&&f(e)){const n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(const c of n)if(!o.includes(c)||!J(t[c],e[c]))return!1;return!0}else return t===e}function K(t){return $(t)==="object"}function Y(t){return Array.isArray(t)}function Q(t){return typeof t=="string"}function C(t){Promise.resolve().then(t)}let w=null;const R=new WeakMap;function mt(t){w=t,t(),w=null}function yt(t){const e=R.get(t)||[],n=e.some(o=>w===o);w&&!n&&(e.push(w),R.set(t,e))}function D(t){const e=R.get(t);e&&e.forEach((n,o)=>{n()===!0&&(e.splice(o,1),R.set(t,e))})}function gt(t){R.delete(t)}const bt=new WeakMap,E=new WeakMap,P={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function U(t){if(!f(t)||Object.isFrozen(t)||bt.get(t))return t;let e=null;return new Proxy(t,{get(n,o,c){if(o===P.RAW)return n;if(f(n[o]))return U(n[o]);const r=Reflect.get(n,o,c);return yt(n),r},set(n,o,c,r){if(n[P.IS_READONLY])return!0;if(f(n[o])){const b=n[o],V=new Set;for(const h in c)V.add(h),this.set(b,h,c[h],r[o]);for(const h in b)V.has(h)||this.deleteProperty(b,h);return!0}if(Reflect.get(n,o,r)===c)return!0;const l=Reflect.set(n,o,c,r),g=E.get(n)||new Set;g.add(o);const at=g.size;return E.set(n,g),C(()=>{const b=Reflect.get(n,o,r);l&&b===c&&at===1&&D(n),E.delete(n)}),l},deleteProperty(n,o){const c=Reflect.get(n,o);if(f(c)){for(const l in c)this.deleteProperty(c,l);return!0}const r=dt(n,o),i=Reflect.deleteProperty(n,o);return e=o,C(()=>{r&&i&&c!==void 0&&o===e&&(D(n),e=null)}),i}})}function wt(t){return!!t[P.RAW]}function St(t){return wt(t)?t[P.RAW]:t}function Rt(t){const e=U({value:t});function n(){return e.value}function o(c){e.value=c}return[n,o]}const _t="__v_isRef";var pe;class vt{constructor(e){a(this,pe,!0);a(this,"__v_isShallow",!1);a(this,"_rawValue");a(this,"_value");a(this,"getSignal");a(this,"setSignal");this._rawValue=e;const[n,o]=Rt(e);this.getSignal=n,this.setSignal=o,this._value=n()}get value(){return this.getSignal()}set value(e){this.setSignal(e),this._rawValue=e}}pe=_t;function At(t){return new vt(t)}const S=function(){const t=new WeakMap,e=["null","weakset","weakmap"],n={set(o){const c=new Set;for(const r of o)c.add(S(r));return c},map(o){const c=new Map;for(const[r,i]of o.entries())c.set(r,S(i));return c}};return function(o){const c=$(o);if(typeof o!="object"||e.includes(c))return o;if(t.has(o))return t.get(o);if(n[c])return n[c](o);const r=Y(o)?[]:{};Object.setPrototypeOf(r,Object.getPrototypeOf(o)),t.set(o,r);for(const i in o)r[i]=S(o[i]);return r}}();function j(t,e){return Object.assign({},t,e)}function Pt(t,e,n={}){let o=!1;if(o)return;const c=t();n.immediate&&e(c,void 0);let r=S(c),i=!0;return mt(()=>{const l=t();if(f(l)){n.deep&&!J(l,r)&&(e(l,r),r=S(l));return}if(i){i=!1;return}l!==r&&(e(l,r),r=l)}),()=>{o=!0}}function jt(t){return["string","number"].includes(typeof t)&&t!==""}function Nt(t){return!/^on/.test(t)}function X(t){return typeof t=="function"&&!tt(t)}function s(t,e,...n){const o={tag:t,attrs:e||{},children:n};return X(o.tag)&&o.children.length===0&&o.attrs.children&&(o.children=o.attrs.children),o}function Z({children:t}){return t}const N=Symbol("Fragment");Z.prototype[N]=N;function tt(t){return typeof t=="function"&&t.prototype[N]===N}function B(t,e={},n=[""]){if(tt(t)){const r=j(e,{children:n}),i=t(r);return T(i)}if(X(t)){const r=j(e,{children:n}),i=t(r);return B(i.tag,i.attrs,i.children)}let o="";for(const r in e){if(r.startsWith("on")||r==="ref")continue;let i=typeof e[r]=="function"&&Nt(r)?e[r]():e[r];if(r==="className"){o+=` class=${i}`;continue}if(r==="style"&&K(i)){for(const l in i)typeof i[l]=="function"&&(i[l]=i[l]());i='"'+JSON.stringify(i).slice(1,-1).replaceAll('"',"").replaceAll(",",";")+'"'}o+=` ${r}=${i}`}const c=T(n);return`<${t}${o}>${c}</${t}>`}function T(t){let e="";return t.forEach(n=>{if(jt(n)){e+=n.toString();return}if(Y(n)){e+=T(n);return}if(typeof n=="function"){const o=n();e+=T([o]);return}if(K(n)){e+=B(n.tag,n.attrs,n.children);return}}),e}function Tt({tag:t,attrs:e,children:n}){return B(t,e,n)}let p="",m,et=!0;function Ot(t){p=t.base||"/",m=t.mode||"history",et=t.isBrowser??!0,t.SSR_DATA_KEY}function M(t){if(Q(t))return t;t=t;const e=t.path;let n="";for(const r in t.query)n+=`&${r}=${t.query[r]}`;n=n?"?"+n:"";const o=t.hash?"#"+t.hash:"";return e+n+o}function Lt(t){const e={};return t.replace("?","").split("&").forEach(o=>{const[c,r]=o.split("=");c&&r&&(e[c]=r)}),e}function y(t){return t.replace(/\/+/g,"/")}const A=U({path:"",query:{},hash:"",meta:{}});function _(t){const e=new URL(y("http://0.0.0.0/"+t));A.path=e.pathname.replace(p,"/"),A.query=Lt(e.search),A.hash=e.hash}function Ut(t){const e=M(t);m==="history"?history.pushState({},"",y(p+"/"+e)):location.hash=e,_(e)}function Et(t){const e=M(t);m==="history"?history.replaceState({},"",y(p+"/"+e)):location.hash=e,_(e)}function It(t){history.go(t)}function kt(){return{push:Ut,replace:Et,go:It}}function nt(t){t.exact??(t.exact=!0);const e=t.component;return s(e,null)}const O=Symbol("Route");nt.prototype[O]=O;function W(t){return typeof t=="function"&&t.prototype[O]===O}function H(t,e){const n=t.find(r=>r.attrs.exact||r.attrs.exact===void 0?e===r.attrs.path:(e+"/").startsWith(y(r.attrs.path+"/")));if(!n)return null;const o={tag:"",attrs:{},children:[]};o.tag=n.attrs.component;const c=[H(n.children,e)].filter(r=>r);if(o.children=c,c.length===0){const r=n.children[n.children.length-1];r&&W(r.tag)&&!r.attrs.path&&(o.children=[j(o,{tag:r.attrs.component})])}if(n.attrs.exact===!1&&o.children.length===0){const r=t[t.length-1];if(r&&W(r.tag)&&!r.attrs.path)return o.tag=r.attrs.component,o}return o}function ot(t,e=[]){const{tag:n,attrs:o,children:c}=t;return e.push({tag:n,attrs:o,children:[]}),c.length>0&&ot(c[0],e),e}function xt(t){const e=function(){return m==="history"?()=>location.href.replace(location.origin+p,""):()=>location.hash.slice(1)}();_(e()),window.addEventListener("popstate",()=>{_(e())});const n=At([]);Pt(()=>A.path,r=>{const i=H(t.children,r);n.value=ot(i)},{immediate:!0});const o=new Array;function c(r=0){return()=>{const i=n.value[r];if(!i)return delete o[r],null;const l=St(i);return r>0&&o[r]&&!l.tag&&gt(o[r]),o[r]=l,s(i.tag,null,c(r+1))}}return s(Z,null,c())}function Ft(t){let e="";if(m==="history")e=t.url.replace(p,"");else{const o=t.url.match(/#.*/);e=o?o[0]:""}_(e);const n=H(t.children,e);return s(n.tag,{children:n.children})}function $t(t){return et?s(xt,{...t}):s(Ft,{...t})}const Bt={to:"/",type:"push"};function L(t){t=j(Bt,t);const e=Q(t.to)?t.to:M(t.to),n=y(p+(m==="hash"?"#"+e:e)),o=kt();function c(r){r.preventDefault(),t.type==="push"?o.push(e):o.replace(e)}return s("a",{href:n,onclick:c},t.children)}const Mt="banner-64e93c",Ht="box-e24f47",Vt="article-e5ab12",Ct="paragraph-6f9bd7",Dt="mark-66b760",Wt="peculiarity-fd110f",d={banner:Mt,box:Ht,article:Vt,paragraph:Ct,mark:Dt,peculiarity:Wt};function x(...t){return t.join(" ").trim().replace(/\s+/," ")}const F={"text/html":[".html"],"text/css":[".css"],"application/javascript;":[".js"],"application/json":[".json"],"image/vnd.microsoft.icon":[".ico"],"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/gif":[".gif"],"application/pdf":[".pdf"],"font/woff2":[".worf2"],"font/woff":[".worf"],"font/ttf":[".ttf"],"application/octet-stream":[".mp4",".avi"]};function qt(){const t=Object.values(F).flat();return[".gz"].concat(t)}function zt(t){t=t.toLowerCase();let e=null;for(const n in F)if(F[n].includes(t)){e=n;break}return e}const u={BASE_URL:"/",NODE_ENV:"production",BASE_API:"/api",DEPLOY_URL:"/",GITHUB_URL:"https://github.com/yubo9807/"};function rt(t){return console.log("home"),s("div",null,s("div",{className:d.banner},s("div",{className:d.box},s("strong",null,"Pl Vue"),s("p",null,"一个 JS 库，只关心数据与函数之间的联动"))),s("article",{className:x("leayer","module-gap",d.article)},s("p",{className:d.paragraph},"Plagiarize Vue 是一个轻量级、不依赖任何第三方库的 JS 数据响应式库，除响应式 API 外，该库还提供了组件化、挂载钩子、Router、Store 以及服务端渲染相关 API，项目搭建可参考  ",s("a",{href:u.GITHUB_URL+"mvvm_vue3"},"GitHub"),"。"),s("p",{className:d.mark},"该库本身与 Vue 框架无任何关系，只是多数 API 在命名上相同而已。")),s("ul",{className:x("leayer","module-gap",d.peculiarity)},s("li",null,s("h2",null,"响不响应式的，高度交予开发者决定"),s("p",null,"JSX 编程方式，响应式数据统一使用函数的方式包裹。",s("a",{href:u.GITHUB_URL+"mvvm_vue3",target:"_blank"},"了解更多"))),s("li",null,s("h2",null,"无虚拟 DOM 参与"),s("p",null,"将用到响应式数据的函数进行收集，在数据更新后执行相应的函数。因此直接省去了虚拟 DOM 的比较。")),s("li",null,s("h2",null,"拿来就用，灵活多变"),s("p",null,"无需脚手架，原生应用亦可构建。",s("a",{href:u.GITHUB_URL+"single-page",target:"_blank"},"代码示例"))),s("li",null,s("h2",null,"代码精简，打包后不到 15k"),s("p",null,"手写 h 与 Fragment，将代码体积精简到极致。"))))}rt.prototype.getInitialProps=async()=>(console.log("home"),"home");const Gt="container-4ac8c9",Jt="side-f9a8bf",Kt="content-a47edb",I={container:Gt,side:Jt,content:Kt};U({tag:1,children:[{tag:2}]});function Yt(t){return s("div",{className:x("leayer",I.container)},s("ul",{className:I.side},s("li",null,s(L,{to:"/docs/use"},"使用")),s("li",null,s(L,{to:"/docs/realize"},"实现"))),s("div",{className:I.content},t.children))}function Qt(){return console.log("use"),s("div",null,"use")}function Xt(){return console.log("realize"),s("div",null,"realize")}const Zt="not-found-710606",te={"not-found":"not-found-710606",notFound:Zt};function ee(){return s("div",{className:te["not-found"]},"404")}const ne="header-d58b7b",oe="navigation-968f91",q={header:ne,navigation:oe};function re(){return s("header",{className:q.header},s("div",null,s(L,{to:"/"},s("h1",null,"Pl Vue"))),s("nav",{className:q.navigation},s(L,{to:"/docs"},"文档"),s("a",{href:u.GITHUB_URL+"mvvm_vue3",target:"_blank"},"GitHub")))}const se="footer-3594d5",ce={footer:se};function ie(){return s("footer",{className:ce.footer},s("strong",null,"⚠️ 注意事项"),s("p",null,"本文文档仅供学习参考。并未发布正式版本，不提供任何商业用途。"))}const le="main-e1cb98",ue={main:le};function st(t){return console.log("layout"),s("div",null,s(re,null),s("main",{className:ue.main},t.children),s(ie,null))}st.prototype.getInitialProps=async()=>"loyout";const ct=[{path:"/",component:st,exact:!1,routes:[{path:"/",component:rt},{path:"/docs",component:Yt,exact:!1,routes:[{path:"/docs/use",component:Qt},{path:"/docs/realize",component:Xt}]}]},{component:ee}];function ae(t){return Ot({base:u.BASE_URL,mode:"history",isBrowser:t.isBrowser}),s($t,{url:t.url,data:t.data},...it(ct))}function it(t){return t?t.map(e=>{const{routes:n,...o}=e;return s(nt,{...o},...it(n))}):[]}const lt=u.DEPLOY_URL.slice(1),v=G.readFileSync(k.resolve(__dirname,lt,"index.html"),"utf-8");async function ut(t,e){const n=t.find(o=>o.exact||o.exact===void 0?e===o.path:(e+"/").startsWith(y(o.path+"/")));return n&&typeof n.component.prototype.getInitialProps=="function"?await n.component.prototype.getInitialProps():n.routes&&n.routes.length>0?await ut(n.routes,e):void 0}const fe=ht.createServer(async(t,e)=>{const n=t.url.replace(u.BASE_URL,"/"),o=k.extname(n);if(qt().includes(o)){const c=k.resolve(__dirname,lt,n.slice(1));G.readFile(c,(r,i)=>{if(r)e.writeHead(404,{"Content-Type":"text/plain"}),e.end("Not Found");else{const l=zt(o);l&&e.setHeader("Content-Type",l),e.write(i),e.end()}})}else{const c=await ut(ct,n),r=Tt(s(ae,{isBrowser:!1,url:n,data:c})),i=v.search("</body>"),l=c===void 0?"":`<script>window.g_initialProps=${JSON.stringify(c)}<\/script>`,g=v.slice(0,i)+l+v.slice(i,v.length);e.write(g.replace("<!--ssr-outlet-->",r)),e.end()}}),z=3e3;fe.listen(z,()=>{console.log(`http://localhost:${z}${u.BASE_URL}`)});
