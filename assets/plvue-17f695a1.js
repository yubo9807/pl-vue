var it=Object.defineProperty;var ut=(t,n,e)=>n in t?it(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var g=(t,n,e)=>(ut(t,typeof n!="symbol"?n+"":n,e),e);function W(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function y(t){return["object","array"].includes(W(t))}function ft(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function K(t,n){if(y(t)&&y(n)){const e=Object.keys(t),r=Object.keys(n);if(e.length!==r.length)return!1;for(const o of e)if(!r.includes(o)||!K(t[o],n[o]))return!1;return!0}else return t===n}function tt(){return typeof window=="object"}function m(t){return W(t)==="object"}function P(t){return Array.isArray(t)}function V(t){return typeof t=="string"}function I(t){Promise.resolve().then(t)}function at(){return Number(Math.random().toString().slice(2)).toString(32)}function A(...t){console.warn(...t)}let S=null;const O=new WeakMap;function M(t){S=t,t(),S=null}function lt(t){const n=O.get(t)||[],e=n.some(r=>S===r);S&&!e&&(n.push(S),O.set(t,n))}function Q(t){const n=O.get(t);n&&n.forEach((e,r)=>{e()===!0&&(n.splice(r,1),O.set(t,n))})}const dt=new WeakMap,F=new WeakMap,G={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function B(t){if(!y(t)||Object.isFrozen(t))return A(`lue cannot be made reactive: ${t}`),t;if(dt.get(t))return t;let n=null;return new Proxy(t,{get(e,r,o){if(r===G.RAW)return e;if(y(e[r]))return B(e[r]);const c=Reflect.get(e,r,o);return lt(e),c},set(e,r,o,c){if(e[G.IS_READONLY])return!0;if(y(e[r])){const f=e[r],a=new Set;for(const l in o)a.add(l),this.set(f,l,o[l],c[r]);for(const l in f)a.has(l)||this.deleteProperty(f,l);return!0}if(Reflect.get(e,r,c)===o)return!0;const i=Reflect.set(e,r,o,c),u=F.get(e)||new Set;u.add(r);const h=u.size;return F.set(e,u),I(()=>{const f=Reflect.get(e,r,c);i&&f===o&&h===1&&Q(e),F.delete(e)}),i},deleteProperty(e,r){const o=Reflect.get(e,r);if(y(o)){for(const i in o)this.deleteProperty(o,i);return!0}const c=ft(e,r),s=Reflect.deleteProperty(e,r);return n=r,I(()=>{c&&s&&o!==void 0&&r===n&&(Q(e),n=null)}),s}})}function pt(t){const n=B({value:t});function e(){return n.value}function r(o){n.value=o}return[e,r]}const ht="__v_isRef";var Tt;class gt{constructor(n){g(this,Tt,!0);g(this,"__v_isShallow",!1);g(this,"_rawValue");g(this,"_value");g(this,"getSignal");g(this,"setSignal");this._rawValue=n;const[e,r]=pt(n);this.getSignal=e,this.setSignal=r,this._value=e()}get value(){return this.getSignal()}set value(n){this.setSignal(n),this._rawValue=n}}Tt=ht;function yt(t){return new gt(t)}const R=function(){const t=new WeakMap,n=["null","weakset","weakmap"],e={set(r){const o=new Set;for(const c of r)o.add(R(c));return o},map(r){const o=new Map;for(const[c,s]of r.entries())o.set(c,R(s));return o}};return function(r){const o=W(r);if(typeof r!="object"||n.includes(o))return r;if(t.has(r))return t.get(r);if(e[o])return e[o](r);const c=P(r)?[]:{};Object.setPrototypeOf(c,Object.getPrototypeOf(r)),t.set(r,c);for(const s in r)c[s]=R(r[s]);return c}}();function U(t,n){return Object.assign({},t,n)}function mt(t,n,e={}){let r=!1;if(r)return;const o=t();e.immediate&&n(o,void 0);let c=R(o),s=!0;return M(()=>{const i=t();if(y(i)){e.deep&&!K(i,c)&&(n(i,c),c=R(i));return}if(s){s=!1;return}i!==c&&(n(i,c),c=i)}),()=>{r=!0}}function E(t){return["string","number"].includes(typeof t)&&t!==""}function wt(t){return!/^on/.test(t)}function $(t){return m(t)&&(V(t.tag)||j(t.tag))}function p(t){return typeof t=="function"&&!j(t)}function q(t){return[void 0,null,"",!0,!1].includes(t)}function _(t){return document.createTextNode(t)}function w(t,n,...e){const r={tag:t,attrs:n||{},children:e};return p(r.tag)&&r.children.length===0&&r.attrs.children&&(r.children=r.attrs.children),r}function et({children:t}){return t}const x=Symbol("Fragment");et.prototype[x]=x;function j(t){return typeof t=="function"&&t.prototype[x]===x}const H=[];function bt(){H.forEach(t=>{t()}),H.length=0}const nt=new WeakMap;function rt(t,n=[]){return t.forEach(e=>{m(e)&&(p(e.tag)?n.push({comp:e.tag,compId:e.tag.prototype._id,props:U(e.attrs,{children:t})}):E(e.tag)&&rt(e.children,n))}),n}function L(t,n=[]){const e=nt.get(t)||[];return n.push(...e),e.forEach(r=>{const o=L(r.comp);n.push(...o)}),n}const St=new Map;function J(t){const n=L(t).map(r=>r.compId);n.unshift(t.prototype._id);const e=[];n.forEach(r=>{const o=St.get(r)||[];e.push(...o)}),e.forEach(r=>{r()})}const X=[];function Rt(){X.forEach(t=>{t()}),X.length=0}const Ct=new Map;function Z(t){const n=L(t).map(r=>r.compId);n.unshift(t.prototype._id);const e=[];n.forEach(r=>{const o=Ct.get(r)||[];e.push(...o)}),e.forEach(r=>{r()})}function b(t,n,e){if(V(t))return z(t,n,e);if(j(t))return N(e);if(p(t)){const r=U(n,{children:e});t.prototype._id=at();const o=t(r);return E(o)?_(o):(nt.set(t,rt(o.children)),b(o.tag,o.attrs,o.children))}}function z(t,n={},e=[""]){if(j(t))return b(t,n,e);const r=document.createElement(t);e.forEach(o=>{if(!q(o)){if(E(o)){const c=_(o);c.nodeValue=o,r.appendChild(c);return}if(typeof o=="function"){const c=N([o]);r.appendChild(c);return}if(P(o)){const c=N(o);r.appendChild(c);return}if($(o)){const c=z(o.tag,o.attrs,o.children);r.appendChild(c);return}if(m(o)&&p(o.tag)){const c=b(o.tag,o.attrs,o.children);r.appendChild(c);return}A(`render: 不支持 ${o} 值渲染`)}});for(const o in n){const c=n[o];r[o]=c,o==="ref"&&(c.value=r),typeof c=="function"&&wt(o)&&M(()=>{r[o]=c()})}if(n.style&&m(n.style))for(const o in n.style){const c=n.style[o];typeof c=="function"?M(()=>r.style[o]=c()):r.style[o]=c}return r}function N(t){const n=document.createDocumentFragment();return t.forEach(e=>{if(!q(e)){if(E(e)){const r=_(e);r.nodeValue=e,n.appendChild(r);return}if(typeof e=="function"){Et(n,e);return}if(P(e)){const r=N(e);n.appendChild(r);return}if($(e)){const r=z(e.tag,e.attrs,e.children);n.appendChild(r);return}if(m(e)&&p(e.tag)){const r=b(e.tag,e.attrs,e.children);n.appendChild(r);return}A(`render: 不支持 ${e} 值渲染`)}}),n}function v(t){if(E(t))return _(t);if($(t)||m(t)&&p(t.tag))return b(t.tag,t.attrs,t.children)}function Et(t,n){let e=[],r=!0,o=null;const c=_("");t.appendChild(c),M(()=>{let s=n();if(s&&m(s)&&j(s.tag)){A("不支持响应式节点片段渲染");return}P(s)||(s=[s]),s=s.filter(u=>!q(u));let i=0;for(;i<s.length;){let u=s[i];const h=i,f=e.findIndex(a=>a.key===h);if(f>=0){if(K(u,e[f].tree)){i++;continue}const a=v(u);if(!a){s.splice(f,1),i++;continue}const l=e[f].tree;p(l.tag)&&Z(l.tag),e[f].node.parentElement.replaceChild(a,e[f].node),p(l.tag)&&J(l.tag),e[f].tree=u,e[f].node=a}else{const a=v(u);if(!a){i++;continue}if(r)t.appendChild(a);else if(e.length===0)o??(o=c.parentElement),o.insertBefore(a,c.nextSibling);else{const l=e[e.length-1].node,st=l.nextSibling;l.parentElement.insertBefore(a,st)}e.push({key:h,tree:u,node:a})}i++}if(e.length>s.length){for(let u=s.length;u<e.length;u++){const h=e[u].tree;p(h.tag)&&Z(h.tag),e[u].node.remove(),p(h.tag)&&J(h.tag)}e.splice(s.length,e.length-s.length)}r=!1})}function It({tag:t,attrs:n,children:e}){const r=b(t,n,e);return Rt(),I(bt),r}function D(t){const n=new URL("http://0.0.0.0"+t);return{path:n.pathname,query:_t(n.search),hash:n.hash}}function Y(t){if(V(t))return t;t=t;const n=t.path;let e="";for(const c in t.query)e+=`&${c}=${t.query[c]}`;e=e?"?"+e:"";const r=t.hash?"#"+t.hash:"";return n+e+r}function _t(t){const n={};return t.replace("?","").split("&").forEach(r=>{const[o,c]=r.split("=");o&&c&&(n[o]=c)}),n}const d={base:"",mode:"history",ssrDataKey:"g_initialProps"};let C=null;function Dt(t={}){if(Object.assign(d,t),tt()){const n=D(ot());C=B(n)}else C??(C=D("/"))}function T(t){const n=D(t);for(const e in n)C[e]=n[e]}function ot(){return d.mode==="history"?location.href.replace(location.origin+d.base,""):location.hash.slice(1)}function Wt(){return C}function jt(t){const n=Y(t);d.mode==="history"?history.pushState({},"",d.base+n):location.hash=n,T(n)}function Ot(t){const n=Y(t);d.mode==="history"?history.replaceState({},"",d.base+n):location.hash=n,T(n)}function Mt(t){history.go(t)}function xt(){return{push:jt,replace:Ot,go:Mt}}function Nt(t){t.exact??(t.exact=!0);const n=t.component;return w(n,null)}const k=Symbol("Route");Nt.prototype[k]=k;function kt(t){return typeof t=="function"&&t.prototype[k]===k}function ct(t,n){const e=t.find(r=>r.attrs.exact||r.attrs.exact===void 0?n===r.attrs.path:(n+"/").startsWith(r.attrs.path+"/"));if(e)return e.attrs.component;{const r=t[t.length-1];if(r&&kt(r.tag)&&!r.attrs.path)return r.attrs.component}}function Pt(t){window.addEventListener("popstate",()=>{T(ot())});const n=yt(null);let e;return mt(()=>C.path,async r=>{const o=ct(t.children,r);if(!o)return;const{getInitialProps:c}=o.prototype;typeof c=="function"&&(window[d.ssrDataKey]?(e=window[d.ssrDataKey],delete window[d.ssrDataKey]):e=await c()),n.value=o},{immediate:!0}),w(et,null,()=>n.value&&w(n.value,{data:e}))}function Vt(t){let n="";if(d.mode==="history")n=t.url.replace(d.base,"");else{const r=t.url.match(/#.*/);n=r?r[0]:""}T(n);const e=ct(t.children,n);return w(e,null)}function Kt(t){return tt()?w(Pt,{...t}):w(Vt,{...t})}const At={to:"/",type:"push"};function Bt(t){t=U(At,t);const n=V(t.to)?t.to:Y(t.to),e=d.base+(d.mode==="hash"?"#"+n:n),r=xt();function o(c){c.preventDefault(),t.type==="push"?r.push(n):r.replace(n)}return w("a",{href:e,onclick:o},t.children)}export{Bt as L,Kt as R,Nt as a,w as h,Dt as i,It as r,Wt as u};
