(()=>{"use strict";function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(t){return["object","array"].includes(e(t))}function n(e,t){if("object"==typeof e&&"object"==typeof t){const r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(const c of r){if(!o.includes(c))return!1;if(!n(e[c],t[c]))return!1}return!0}return e===t}let r=null;const o=new WeakMap;function c(e){r=e,e(),r=null}function l(e){const t=o.get(e);t&&t.forEach(((n,r)=>{const c=n();"boolean"==typeof c&&c&&(t.splice(r,1),o.set(e,t))}))}const i=new WeakMap,s={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function u(e){return!t(e)||i.get(e)?e:new Proxy(e,{get(e,n,c){if(n===s.RAW)return e;!function(e){const t=o.get(e)||[];r&&t.push(r),o.set(e,t)}(e);const l=Reflect.get(e,n,c);return t(l)?u(l):l},set(e,t,n,r){const o=Reflect.get(e,t,r),c=Reflect.set(e,t,n,r);return e[s.IS_READONLY]?o:(c&&o!==n&&l(e),c)},deleteProperty(e,t){const n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t),r=Reflect.deleteProperty(e,t);return n&&r&&l(e),r}})}class a{__v_isRef=!0;__v_isShallow=!1;_rawValue;_value;constructor(e){this._rawValue=e,this._value=t(e)?u(e):u({value:e})}get value(){return t(this._rawValue)?this._value:this._value.value}set value(e){this._rawValue=e,t(e)?this._value=e:this._value.value=e}}function f(e,t,...n){return{tag:e,attrs:t||{},children:n}}function d({children:e}){return e}const p=Symbol("Fragment");function h(e){return"function"==typeof e&&e.prototype[p]===p}d.prototype[p]=p;const g=[];function y(){g.forEach((e=>{e()}))}function m(e){return["string","number"].includes(typeof e)&&""!==e}function v(e){return["className","innerHTML","innerText","textContent"].includes(e)}function _(t){return"object"===e(t)&&("string"==typeof t.tag||h(t.tag))}function b(t){return t instanceof Array?function(e){let t=new Array(e.length);for(let n=0;n<t.length;n++)t[n]=b(e[n]);return t}(t):"object"===e(t)?function(e){let t={},n=Object.getOwnPropertyNames(e);for(let r=0;r<n.length;r++)t[n[r]]=b(e[n[r]]);return t}(t):t}function w(t,n={},r=[]){if("function"==typeof t&&!h(t)){const e=t(b(Object.assign({},n,{children:r})));return w(e.tag,e.attrs,e.children)}const o=[];return r.forEach((t=>{if("object"===e(t)){const e=w(t.tag,t.attrs,t.children);o.push(e)}else o.push(t)})),{tag:t,attrs:n,children:o}}function j(e,t,n){return"string"==typeof e?E(e,t,n):h(e)?C(n):void 0}function E(e,t={},n=[""]){if(h(e))return j(e,t,n);const r=document.createElement(e);n.forEach((e=>{if(m(e)){const t=document.createTextNode(e);return t.nodeValue=e,void r.appendChild(t)}if("function"!=typeof e)if(e instanceof Array){const t=C(e);r.appendChild(t)}else if(_(e)){const t=E(e.tag,e.attrs,e.children);r.appendChild(t)}else console.warn(`render: 不支持 ${e} 值渲染`);else{const t=C([e]);r.appendChild(t)}}));for(const e in t){const n=t[e];r[e]=n,"ref"===e&&(n.value=r),"function"==typeof n&&v(e)&&c((()=>{r[e]=n()}))}if(t.style&&t.style instanceof Object)for(const e in t.style){const n=t.style[e];"function"==typeof n?c((()=>r.style[e]=n())):r.style[e]=n}return r}function C(e){const t=document.createDocumentFragment();return e.forEach((e=>{if(m(e)){const n=document.createTextNode(e);return n.nodeValue=e,void t.appendChild(n)}if("function"==typeof e){let r=[],o=0;const l=document.createTextNode("");return t.appendChild(l),void c((()=>{let c=e();if(c instanceof Array||(c=[c]),c=c.filter((e=>e)),c.forEach(((e,c)=>{const i=c,s=r.findIndex((e=>e.key===i));if(s>=0){if(n(e,r[s].tree))return;const t=N(e);r[s].node.parentElement.replaceChild(t,r[s].node),r[s].tree=e,r[s].node=t}else{const n=N(e);if(0===o)t.appendChild(n);else if(0===r.length)l.parentElement.insertBefore(n,l.nextSibling);else{const e=r[r.length-1].node,t=e.nextSibling;e.parentElement.insertBefore(n,t)}r.push({key:i,tree:e,node:n})}})),r.length>c.length)for(let e=c.length;e<r.length;e++)r[e].node.remove(),r.splice(e,1);o++}))}if(e instanceof Array){const n=C(e);t.appendChild(n)}else if(_(e)){const n=E(e.tag,e.attrs,e.children);t.appendChild(n)}else console.warn(`render: 不支持 ${e} 值渲染`)})),t}function N(t){if(m(t))return document.createTextNode(t.toString());if(_(t))return j(t.tag,t.attrs,t.children);if("object"===e(t)&&!h(n=t.tag)&&"function"==typeof n){const e=w(t.tag,t.attrs,t.children);return j(e.tag,e.attrs,e.children)}var n}const O="demo__bac49";function x(e){return f("div",null,f("p",null,"子组件"),f("p",null,"props: ",e.count),f("p",null,e.children))}document.getElementById("root").appendChild(function({tag:e,attrs:t,children:n}){const r=w(e,t,n),o=j(r.tag,r.attrs,r.children);if(o instanceof DocumentFragment){const e=o.children[0];Promise.resolve().then((()=>{e.parentNode&&y()}))}else o instanceof HTMLElement&&Promise.resolve().then((()=>{o.parentNode&&y()}));return o}(f((function(){const e=new a(1);return f(d,null,"父组件",f("h1",{className:O},(()=>e.value)),f(x,{count:()=>e.value},f("p",null,"插槽1"),f("p",null,"插槽2")),f("button",{onclick:()=>e.value++},"click"))}),null)))})();