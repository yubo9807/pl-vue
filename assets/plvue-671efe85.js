var mt=Object.defineProperty;var yt=(t,n,e)=>n in t?mt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var w=(t,n,e)=>(yt(t,typeof n!="symbol"?n+"":n,e),e);function U(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function b(t){return["object","array"].includes(U(t))}function wt(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function q(t,n){if(b(t)&&b(n)){const e=Object.keys(t),r=Object.keys(n);if(e.length!==r.length)return!1;for(const o of e)if(!r.includes(o)||!q(t[o],n[o]))return!1;return!0}else return t===n}function st(){return typeof window=="object"}function d(t){return U(t)==="object"}function C(t){return Array.isArray(t)}function W(t){return typeof t=="string"}function A(t){Promise.resolve().then(t)}function bt(){return Number(Math.random().toString().slice(2)).toString(32)}function j(...t){console.warn(...t)}let _=null;const T=new WeakMap;function $(t){_=t,t(),_=null}function Rt(t){const n=T.get(t)||[],e=n.some(r=>_===r);_&&!e&&(n.push(_),T.set(t,n))}function Z(t){const n=T.get(t);n&&n.forEach((e,r)=>{e()===!0&&(n.splice(r,1),T.set(t,n))})}const St=new WeakMap,I=new WeakMap,x={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function H(t){if(!b(t)||Object.isFrozen(t))return j(`lue cannot be made reactive: ${t}`),t;if(St.get(t))return t;let n=null;return new Proxy(t,{get(e,r,o){if(r===x.RAW)return e;if(b(e[r]))return H(e[r]);const s=Reflect.get(e,r,o);return Rt(e),s},set(e,r,o,s){if(e[x.IS_READONLY])return!0;if(b(e[r])){const a=e[r],h=new Set;for(const g in o)h.add(g),this.set(a,g,o[g],s[r]);for(const g in a)h.has(g)||this.deleteProperty(a,g);return!0}if(Reflect.get(e,r,s)===o)return!0;const u=Reflect.set(e,r,o,s),i=I.get(e)||new Set;i.add(r);const f=i.size;return I.set(e,i),A(()=>{const a=Reflect.get(e,r,s);u&&a===o&&f===1&&Z(e),I.delete(e)}),u},deleteProperty(e,r){const o=Reflect.get(e,r);if(b(o)){for(const u in o)this.deleteProperty(o,u);return!0}const s=wt(e,r),c=Reflect.deleteProperty(e,r);return n=r,A(()=>{s&&c&&o!==void 0&&r===n&&(Z(e),n=null)}),c}})}function Et(t){return!!t[x.RAW]}function ct(t){return Et(t)?t[x.RAW]:t}function _t(t){const n=H({value:t});function e(){return n.value}function r(o){n.value=o}return[e,r]}const kt="__v_isRef";var Kt;class Mt{constructor(n){w(this,Kt,!0);w(this,"__v_isShallow",!1);w(this,"_rawValue");w(this,"_value");w(this,"getSignal");w(this,"setSignal");this._rawValue=n;const[e,r]=_t(n);this.getSignal=e,this.setSignal=r,this._value=e()}get value(){return this.getSignal()}set value(n){this.setSignal(n),this._rawValue=n}}Kt=kt;function Ct(t){return new Mt(t)}const k=function(){const t=new WeakMap,n=["null","weakset","weakmap"],e={set(r){const o=new Set;for(const s of r)o.add(k(s));return o},map(r){const o=new Map;for(const[s,c]of r.entries())o.set(s,k(c));return o}};return function(r){const o=U(r);if(typeof r!="object"||n.includes(o))return r;if(t.has(r))return t.get(r);if(e[o])return e[o](r);const s=C(r)?[]:{};Object.setPrototypeOf(s,Object.getPrototypeOf(r)),t.set(r,s);for(const c in r)s[c]=k(r[c]);return s}}();function M(t,n){return Object.assign({},t,n)}function jt(t,n,e={}){let r=!1;if(r)return;const o=t();e.immediate&&n(o,void 0);let s=k(o),c=!0;return $(()=>{if(r)return!0;const u=t();if(b(u)){e.deep&&!q(u,s)&&(n(u,s),s=k(u));return}if(c){c=!1;return}u!==s&&(n(u,s),s=u)}),()=>{r=!0}}function S(t){return["string","number"].includes(typeof t)&&t!==""}function it(t){return!/^on/.test(t)}function z(t){return d(t)&&(W(t.tag)||E(t.tag))}function p(t){return typeof t=="function"&&!E(t)}function Y(t){return[void 0,null,"",!0,!1].includes(t)}function N(t){return document.createTextNode(t)}function y(t,n,...e){const r={tag:t,attrs:n||{},children:e};return p(r.tag)&&r.children.length===0&&r.attrs.children&&(r.children=r.attrs.children),r}function F({children:t}){return t}const L=Symbol("Fragment");F.prototype[L]=L;function E(t){return typeof t=="function"&&t.prototype[L]===L}let ut=!1;function v(t){ut=t}const B=[];let ft=!1;function Nt(t){if(!ut){if(ft){A(t);return}B.push(t)}}function Ot(){B.forEach(t=>{t()}),B.length=0,ft=!0}const lt=new WeakMap;function at(t,n=[]){return t.forEach(e=>{d(e)&&(p(e.tag)?n.push({comp:e.tag,compId:e.tag.prototype._id,props:M(e.attrs,{children:t})}):S(e.tag)&&at(e.children,n))}),n}function J(t,n=[]){const e=lt.get(t)||[];return n.push(...e),e.forEach(r=>{const o=J(r.comp);n.push(...o)}),n}const At=new Map;function tt(t){const n=J(t).map(r=>r.compId);n.unshift(t.prototype._id);const e=[];n.forEach(r=>{const o=At.get(r)||[];e.push(...o)}),e.forEach(r=>{r()})}const et=[];function Tt(){et.forEach(t=>{t()}),et.length=0}const $t=new Map;function nt(t){const n=J(t).map(r=>r.compId);n.unshift(t.prototype._id);const e=[];n.forEach(r=>{const o=$t.get(r)||[];e.push(...o)}),e.forEach(r=>{r()})}function R(t,n,e){if(W(t))return Q(t,n,e);if(E(t))return P(e);if(p(t)){const r=M(n,{children:e});t.prototype._id=bt();const o=t(r);return S(o)?N(o):(lt.set(t,at(o.children)),R(o.tag,o.attrs,o.children))}}function Q(t,n={},e=[""]){if(E(t))return R(t,n,e);const r=document.createElement(t);e.forEach(o=>{if(!Y(o)){if(S(o)){const s=N(o);s.nodeValue=o,r.appendChild(s);return}if(typeof o=="function"){const s=P([o]);r.appendChild(s);return}if(C(o)){const s=P(o);r.appendChild(s);return}if(z(o)){const s=Q(o.tag,o.attrs,o.children);r.appendChild(s);return}if(d(o)&&p(o.tag)){const s=R(o.tag,o.attrs,o.children);r.appendChild(s);return}j(`render: 不支持 ${o} 值渲染`)}});for(const o in n){const s=n[o];r[o]=s,o==="ref"&&(s.value=r),typeof s=="function"&&it(o)&&$(()=>{r[o]=s()})}if(n.style&&d(n.style))for(const o in n.style){const s=n.style[o];typeof s=="function"?$(()=>r.style[o]=s()):r.style[o]=s}return r}function P(t){const n=document.createDocumentFragment();return t.forEach(e=>{if(!Y(e)){if(S(e)){const r=N(e);r.nodeValue=e,n.appendChild(r);return}if(typeof e=="function"){Lt(n,e);return}if(C(e)){const r=P(e);n.appendChild(r);return}if(z(e)){const r=Q(e.tag,e.attrs,e.children);n.appendChild(r);return}if(d(e)&&p(e.tag)){const r=R(e.tag,e.attrs,e.children);n.appendChild(r);return}j(`render: 不支持 ${e} 值渲染`)}}),n}function rt(t){if(S(t))return N(t);if(z(t)||d(t)&&p(t.tag))return R(t.tag,t.attrs,t.children)}function xt(t,n){let e=0,r=t.length-1;for(;e<=r;){var o=Math.ceil((e+r)/2);if(n===t[o].key)return o;n<t[o].key?r=o-1:n>t[o].key&&(e=o+1)}return-1}function Lt(t,n){let e=[],r=!0,o=null;const s=N("");t.appendChild(s),$(()=>{let c=n();if(c&&d(c)&&E(c.tag)){j("不支持响应式节点片段渲染");return}C(c)||(c=[c]),c=c.filter(i=>!Y(i));let u=0;for(;u<c.length;){let i=c[u];const f=xt(e,u);if(f>=0){if(q(i,e[f].tree)){u++;continue}const a=rt(i);if(!a){c.splice(f,1),u++;continue}const h=e[f].tree;p(h.tag)&&nt(h.tag),e[f].node.parentElement.replaceChild(a,e[f].node),p(h.tag)&&tt(h.tag),e[f].tree=i,e[f].node=a}else{const a=rt(i);if(!a){u++;continue}if(r)t.appendChild(a);else if(e.length===0)o??(o=s.parentElement),o.insertBefore(a,s.nextSibling);else{const h=e[e.length-1].node,g=h.nextSibling;h.parentElement.insertBefore(a,g)}e.push({key:u,tree:i,node:a})}u++}if(e.length>c.length){for(let i=c.length;i<e.length;i++){const f=e[i].tree;p(f.tag)&&nt(f.tag),e[i].node.remove(),p(f.tag)&&tt(f.tag)}e.splice(c.length,e.length-c.length)}r=!1})}function G(t,n={},e=[""]){if(E(t)){const s=M(n,{children:e}),c=t(s);return V(c)}if(p(t)){const s=M(n,{children:e}),c=t(s);return G(c.tag,c.attrs,c.children)}let r="";for(const s in n){if(s.startsWith("on")||s==="ref")continue;let c=typeof n[s]=="function"&&it(s)?n[s]():n[s];if(s==="className"){r+=` class=${c}`;continue}if(s==="style"&&d(c)){for(const u in c)typeof c[u]=="function"&&(c[u]=c[u]());c='"'+JSON.stringify(c).slice(1,-1).replaceAll('"',"").replaceAll(",",";")+'"'}r+=` ${s}=${c}`}const o=V(e);return`<${t}${r}>${o}</${t}>`}function V(t){let n="";return t.forEach(e=>{if(S(e)){n+=e.toString();return}if(C(e)){n+=V(e);return}if(typeof e=="function"){const r=e();n+=V([r]);return}if(d(e)){n+=G(e.tag,e.attrs,e.children);return}j(`renderToString: 不支持 ${e} 值渲染`)}),n}function qt({tag:t,attrs:n,children:e}){const r=R(t,n,e);return Tt(),A(Ot),r}function Pt({tag:t,attrs:n,children:e}){v(!0);const r=G(t,n,e);return v(!1),r}function K(t){const n=new URL("http://0.0.0.0"+t),e=n.pathname,r=l.routes.find(o=>e.startsWith(o.path+"/")&&o.exact===!1);return{monitor:r?r.path:e,fullPath:n.href.replace(n.origin,""),path:e,query:Vt(n.search),hash:n.hash}}function X(t){if(W(t))return t;t=t;const n=t.path;let e="";for(const s in t.query)e+=`&${s}=${t.query[s]}`;e=e?"?"+e:"";const r=t.hash?"#"+t.hash:"";return n+e+r}function Vt(t){const n={};return t.replace("?","").split("&").forEach(r=>{const[o,s]=r.split("=");o&&s&&(n[o]=s)}),n}function pt(){return l.mode==="history"?location.href.replace(location.origin+l.base,""):location.hash.slice(1)}function ht(t){const{routes:n}=l,e=n.find(o=>o.path===t);if(e)return e;const r=n[n.length-1];if(r.path===void 0&&r.component)return r}function dt(t){const n=X(t);l.mode==="history"?history.pushState({},"",l.base+n):location.hash=n,D(n)}function gt(t){const n=X(t);l.mode==="history"?history.replaceState({},"",l.base+n):location.hash=n,D(n)}function O(t){history.go(t)}function Wt(){return{push:dt,replace:gt,go:O}}const l={base:"",mode:"history",ssrDataKey:"g_initialProps",routes:[]};let m=null;function Ht(t={}){if(Object.assign(l,t),st()){const n=K(pt());m=H(n)}else m??(m=K("/"));return{back:()=>O(-1),forward:()=>O(1),go:O,push:dt,replace:gt,options:l,currentRoute:ct(m)}}function D(t){const n=K(t);for(const e in n)m[e]=n[e]}function zt(){return m}function Yt(t){function n(e){const r=[],o=t.children.map(i=>(i.tag==="title"?r.push(new RegExp("<title")):i.tag==="meta"&&i.attrs.name&&r.push(new RegExp(`<meta name=("|')?${i.attrs.name}`)),Pt(i))),s=e.split(`
`),c=[];t:for(let i=0;i<s.length;i++){s[i]=s[i].trim();for(let f=0;f<r.length;f++)if(r[f].test(s[i])){c.push(i);continue t}}return s.push(...o),s.filter((i,f)=>!c.includes(f)).join(`
`)}return Nt(()=>{const e=document.head,r=n(e.innerHTML);e.innerHTML=r}),y(F,null)}let Ft,ot="/";function Dt(){let t="";if(l.mode==="history")t=ot.replace(l.base,"");else{const e=ot.match(/#.*/);t=e?e[0]:""}D(t);const n=ht(m.monitor);return y(F,null,n&&y(n.component,{data:Ft}))}function It(t){window.addEventListener("popstate",()=>{D(pt())});const n=Ct(null);let e;return jt(()=>m.monitor,async r=>{const o=ht(r);if(!o)return;const{getInitialProps:s}=o.component.prototype;if(typeof s=="function")if(window[l.ssrDataKey])e=window[l.ssrDataKey],delete window[l.ssrDataKey];else{n.value=t.loading;const c=ct(m);e=await s(c)}n.value=o.component},{immediate:!0}),y(F,null,()=>n.value&&y(n.value,{data:e}))}function Jt(t){return st()?y(It,{...t}):y(Dt,null)}const Bt={to:"/",type:"push"};function Qt(t){t=M(Bt,t);const n=W(t.to)?t.to:X(t.to),e=l.base+(l.mode==="hash"?"#"+n:n),r=Wt();function o(s){s.preventDefault(),t.type==="push"?r.push(n):r.replace(n)}return y("a",{className:t.className,href:e,onclick:o},t.children)}export{Yt as H,Qt as L,Jt as R,qt as a,Ht as c,y as h,A as n,Nt as o,Ct as r,zt as u,jt as w};
