(()=>{"use strict";function t(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function e(e){return["object","array"].includes(t(e))}function n(t,e){if("object"==typeof t&&"object"==typeof e){const o=Object.keys(t),r=Object.keys(e);if(o.length!==r.length)return!1;for(const c of o){if(!r.includes(c))return!1;if(!n(t[c],e[c]))return!1}return!0}return t===e}function o(t){if(void 0!==typeof Promise)Promise.resolve().then(t);else if(void 0!==typeof MutationObserver){const e=new MutationObserver(t),n=document.createTextNode("0");e.observe(n,{characterData:!0}),n.data="1"}else void 0!==typeof process?process.nextTick(t):setTimeout(t,0)}let r=null;const c=new WeakMap;function i(t){r=t,t(),r=null}function s(t){const e=c.get(t);e&&e.forEach(((n,o)=>{const r=n();"boolean"==typeof r&&r&&(e.splice(o,1),c.set(t,e))}))}const l=new WeakMap,a={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function u(t){return!e(t)||l.get(t)?t:new Proxy(t,{get(t,n,o){if(n===a.RAW)return t;!function(t){const e=c.get(t)||[],n=e.some((t=>r===t));r&&!n&&e.push(r),c.set(t,e)}(t);const i=Reflect.get(t,n,o);return e(i)?u(i):i},set(t,e,n,r){const c=Reflect.get(t,e,r),i=Reflect.set(t,e,n,r);return t[a.IS_READONLY]?c:(o((()=>{const o=Reflect.get(t,e,r);i&&c!==n&&o===n&&s(t)})),i)},deleteProperty(t,e){const n=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,e),o=Reflect.deleteProperty(t,e);return n&&o&&s(t),o}})}const f="__v_isRef";class h{[f]=!0;__v_isShallow=!1;_rawValue;_value;constructor(t){this._rawValue=t,this._value=e(t)?u(t):u({value:t})}get value(){return e(this._rawValue)?this._value:this._value.value}set value(t){this._rawValue=t,e(t)?this._value=t:this._value.value=t}}class d{fn;constructor(t){this.fn=t}}class p{__v_isReadonly=!0;[f]=!0;_cacheable=!0;_dirty=!0;computed;_setter;constructor(t,e){this.computed=new d(t),this._setter=e}get value(){return this.computed.fn()}set value(t){this._setter?this._setter(t):console.warn("Write operation failed: computed value is readonly")}}function g(e){return e instanceof Array?function(t){let e=new Array(t.length);for(let n=0;n<e.length;n++)e[n]=g(t[n]);return e}(e):"object"===t(e)?function(t){let e={},n=Object.getOwnPropertyNames(t);for(let o=0;o<n.length;o++)e[n[o]]=g(t[n[o]]);return e}(e):e}function y(t){return["string","number"].includes(typeof t)&&""!==t}function m(t){return["className","innerHTML","innerText","textContent"].includes(t)}function v(e){return"object"===t(e)&&("string"==typeof e.tag||j(e.tag))}function b(t){return"function"==typeof t&&!j(t)}function _(t,e,...n){return b(t)&&(t.prototype._id=Number(Math.random().toString().slice(2)).toString(32)),{tag:t,attrs:e||{},children:n}}function w({children:t}){return t}const E=Symbol("Fragment");function j(t){return"function"==typeof t&&t.prototype[E]===E}w.prototype[E]=E;let R=!1;function C(e){R=!0;const n=[];return function e(o){if("object"!==t(o))return;const{tag:r,attrs:c,children:i}=o,s=Object.assign({},c,{children:i});b(r)?(n.push(r.prototype._id),e(r(s))):i.forEach((t=>{e(t)}))}(e),R=!1,n}const O=[];let S=!1;function N(){O.forEach((t=>{t()})),O.length=0,S=!0}const x=new Map;function k(t){C(t).forEach((t=>{const e=x.get(t)||[];0!==e.length&&(e.forEach((t=>t())),x.delete(t))}))}const M=[];let T=!1;const A=new Map;function P(t){C(t).forEach((t=>{const e=A.get(t)||[];0!==e.length&&(e.forEach((t=>t())),A.delete(t))}))}function L(t,e,n){if("string"==typeof t)return V(t,e,n);if(j(t))return D(n);if(b(t)){const o=t(Object.assign({},e,{children:n}));return L(o.tag,o.attrs,o.children)}}function V(e,n={},o=[""]){if(j(e))return L(e,n,o);const r=document.createElement(e);o.forEach((e=>{if(y(e)){const t=document.createTextNode(e);return t.nodeValue=e,void r.appendChild(t)}if("function"!=typeof e)if(e instanceof Array){const t=D(e);r.appendChild(t)}else if(v(e)){const t=V(e.tag,e.attrs,e.children);r.appendChild(t)}else if("object"===t(e)&&b(e.tag)){const t=L(e.tag,e.attrs,e.children);r.appendChild(t)}else console.warn(`render: 不支持 ${e} 值渲染`);else{const t=D([e]);r.appendChild(t)}}));for(const t in n){const e=n[t];r[t]=e,"ref"===t&&(e.value=r),"function"==typeof e&&m(t)&&i((()=>{r[t]=e()}))}if(n.style&&n.style instanceof Object)for(const t in n.style){const e=n.style[t];"function"==typeof e?i((()=>r.style[t]=e())):r.style[t]=e}return r}function D(e){const o=document.createDocumentFragment();return e.forEach((e=>{if(y(e)){const t=document.createTextNode(e);return t.nodeValue=e,void o.appendChild(t)}if("function"==typeof e){let r=[],c=!0,s=null;const l=document.createTextNode("");return o.appendChild(l),void i((()=>{let i=e();if(i&&t(i)&&j(i.tag))return void console.warn("不支持响应式节点片段渲染");i instanceof Array||(i=[i].filter((t=>!function(t){return[void 0,null,"",!0,!1].includes(t)}(t))));let a=0;for(;a<i.length;){const t=i[a],e=a,u=r.findIndex((t=>t.key===e));if(u>=0){if(n(t,r[u].tree)){a++;continue}const e=W(t),o=r[u].tree;b(o.tag)&&P(o),r[u].node.parentElement.replaceChild(e,r[u].node),b(o.tag)&&k(o),r[u].tree=t,r[u].node=e}else{const n=W(t);if(c)o.appendChild(n);else if(0===r.length)s??=l.parentElement,s.insertBefore(n,l.nextSibling);else{const t=r[r.length-1].node,e=t.nextSibling;t.parentElement.insertBefore(n,e)}r.push({key:e,tree:t,node:n})}a++}if(r.length>i.length){for(let t=i.length;t<r.length;t++){const e=r[t].tree;b(e.tag)&&P(e),r[t].node.remove(),b(e.tag)&&k(e)}r.splice(i.length,r.length-i.length)}c=!1}))}if(e instanceof Array){const t=D(e);o.appendChild(t)}else if(v(e)){const t=V(e.tag,e.attrs,e.children);o.appendChild(t)}else if("object"===t(e)&&b(e.tag)){const t=L(e.tag,e.attrs,e.children);o.appendChild(t)}else console.warn(`render: 不支持 ${e} 值渲染`)})),o}function W(e){return y(e)?document.createTextNode(e.toString()):v(e)||"object"===t(e)&&b(e.tag)?L(e.tag,e.attrs,e.children):void 0}const q="demo__bac49";function I(t){const e=t.path;let n="";for(const e in t.query)n+=`&${e}=${t.query[e]}`;return n=n?"?"+n:"",e+n+(t.hash?"#"+t.hash:"")}function $(t){return t.replace(/\/+/g,"/")}const B=u({fullPath:"",hash:"",matched:[],meta:{},name:"",query:{},path:""});function F(t){const e=new URL(t);B.path=e.pathname.replace(J,""),B.query=function(t){const e={};return t.replace("?","").split("&").forEach((t=>{const[n,o]=t.split("=");n&&o&&(e[n]=o)})),e}(e.search),B.hash=e.hash.replace("#",""),B.fullPath=B.path+e.search+e.hash,B.meta=history.state||{},B.matched=function(t){const e=[];return function n(o){for(let r=0;r<o.length;r++){const c=o[r];if(t.startsWith(c.path)){if(e.push(c),t===c.path)break;c.children&&c.children.length>0&&n(c.children)}}}(K),e.reverse()}(B.path)}function H(t){let e="";e="string"==typeof t?$(J+t):I(t),history.pushState({},null,e),F(location.href)}function Y(t){let e="";e="string"==typeof t?$(J+t):I(t),history.replaceState({},null,e),F(location.href)}function U(t){history.go(t),F(location.href)}function z(){const t=[];return function e(n){for(let o=0;o<n.length;o++){const r=n[o];t.push(r),r.children&&r.children.length>0&&e(r.children)}}(K),t}function G(){return{currentRoute:B,getRoutes:z,go:U,forward:()=>U(1),back:()=>U(-1),options:{history:{base:J},routes:K},push:H,replace:Y}}let J="/dist",K=[];function Q(){const t=new h(null);return function(t,e,o={}){const r=t();let c=g(r);o.immediate&&e(r,void 0),i((()=>{const r=t();(o.deep?n(r,c):r===c)||(e(r,u(c)),c=g(r))}))}((()=>B.path),(e=>{const n=G().getRoutes().find((t=>t.path===e));n&&(t.value=n.component)}),{immediate:!0}),_(w,null,(()=>_(t.value,null)))}function X(t){const e="function"==typeof(n=()=>{const e=t.to;return"string"==typeof e?e:I(e)})?new p(n):new p(n.get,n.set);var n;const o=G();return _("a",{href:e.value,onclick:function(t){t.preventDefault(),o.push(e.value)}},t.children)}const Z=[{path:"/",component:function t(){return e=t,n=()=>{console.log("首页被卸载")},R||o((()=>{const t=e.prototype._id,o=x.get(t)||[],r=o.some((t=>t===n));r||(o.push(n),x.set(t,o))})),_("div",{className:q},"home");var e,n}},{path:"/about",component:function(){return _("div",null,"about")}}],tt=document.getElementById("root");var et;J=(et={base:"/dist",routes:Z}).base,K=g(et.routes),function t(e,n=""){e.forEach((e=>{e.path=$(n+e.path),e.children&&e.children.length>0&&t(e.children,e.path)}))}(K),F(location.href),window.addEventListener("popstate",(()=>{F(location.href)})),G(),tt.appendChild(function({tag:t,attrs:e,children:n}){const r=L(t,e,n);if(M.forEach((t=>{t()})),M.length=0,T=!0,r instanceof DocumentFragment){const t=r.children[0];o((()=>{t.parentNode&&N()}))}else r instanceof HTMLElement&&o((()=>{r.parentNode&&N()}));return r}(_((function(){return _(w,null,_("div",null,"My Vue"),_(X,{to:{path:"/"}},"首页"),_(X,{to:{path:"/about"}},"关于"),_(Q,null))}),null)))})();