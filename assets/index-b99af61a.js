var Qt=Object.defineProperty;var Xt=(t,e,n)=>e in t?Qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(Xt(t,typeof e!="symbol"?e+"":e,n),n),gt=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var mt=(t,e,n)=>(gt(t,e,"read from private field"),n?n.call(t):e.get(t)),yt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},k=(t,e,n,o)=>(gt(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function nt(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function b(t){return["object","array"].includes(nt(t))}function Zt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ot(t,e){if(b(t)&&b(e)){const n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(const r of n)if(!o.includes(r)||!ot(t[r],e[r]))return!1;return!0}else return t===e}function d(t){return nt(t)==="object"}function x(t){return Array.isArray(t)}function G(t){return typeof t=="string"}function m(t){Promise.resolve().then(t)}function te(){return Number(Math.random().toString().slice(2)).toString(32)}function y(...t){console.warn(...t)}let $=null;const D=new WeakMap;function P(t){$=t,t(),$=null}function ee(t){const e=D.get(t)||[],n=e.some(o=>$===o);$&&!n&&(e.push($),D.set(t,e))}function _t(t){const e=D.get(t);e&&e.forEach((n,o)=>{const r=n();typeof r=="boolean"&&r&&(e.splice(o,1),D.set(t,e))})}function Pt(t){return Reflect.defineProperty(t,E.IS_READONLY,{value:!0}),new Proxy(t,{get(e,n){return n===E.RAW?e:Reflect.get(e,n)},set(e,n,o){const r=Reflect.get(e,n);return y(`Set operation on key '${n.toString()}' failed: target is readonly.`,{[n.toString()]:r}),r},deleteProperty(e,n){const o=Reflect.get(e,n);return y(`Delete operation on key '${n.toString()}' failed: target is readonly.`,{[n.toString()]:o}),o}})}function ne(t){return t&&Pt(t)[E.IS_READONLY]}const jt=new WeakMap,E={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function N(t){if(!b(t)||Object.isFrozen(t))return y(`lue cannot be made reactive: ${t}`),t;if(jt.get(t))return t;let e=null;return new Proxy(t,{get(n,o,r){if(o===E.RAW)return n;ee(n);const s=Reflect.get(n,o,r);return b(s)?N(s):s},set(n,o,r,s){const u=Reflect.get(n,o,s),i=Reflect.set(n,o,r,s);return n[E.IS_READONLY]?u:(m(()=>{const f=Reflect.get(n,o,s);i&&u!==r&&f===r&&_t(n)}),i)},deleteProperty(n,o){Reflect.get(n,o),Zt(n,o);const r=Reflect.deleteProperty(n,o);return e=o,m(()=>{o===e&&(_t(n),e=null)}),r}})}function rt(t){return!!t[E.RAW]}function oe(t){return rt(t)?t[E.RAW]:t}function re(t){return rt(t)||ne(t)}function se(t){return b(t)&&jt.set(t,!0),t}function Mt(t){const e=N({value:t});function n(){return e.value}function o(r){e.value=r}return[n,o]}const st="__v_isRef";var Qe;class Lt{constructor(e){l(this,Qe,!0);l(this,"__v_isShallow",!1);l(this,"_rawValue");l(this,"_value");l(this,"getSignal");l(this,"setSignal");this._rawValue=e;const[n,o]=Mt(e);this.getSignal=n,this.setSignal=o,this._value=n()}get value(){return this.getSignal()}set value(e){this.setSignal(e),this._rawValue=e}}Qe=st;function F(t){return new Lt(t)}function It(t){return t&&!!t[st]}function ue(t){return It(t)?t.value:t}class $t{constructor(e,n,o=void 0){l(this,"__v_isRef",!0);l(this,"_defaultValue");l(this,"_key");l(this,"_object");this._defaultValue=o,this._key=n,this._object=e}get value(){return this._object[this._key]}set value(e){this._object[this._key]=e}}function ie(t,e,n=void 0){return new $t(t,e,n)}function ce(t){const e={};for(const n in t)e[n]=new $t(t,n);return e}class le extends Lt{constructor(n){let o=!1;const{get:r,set:s}=n(()=>o=!0,()=>this.setValue());super(r());l(this,"_get");l(this,"_set");this.__v_isRef=o,this._get=r,this._set=s}get value(){return this.__v_isRef?super.value:this._get()}set value(n){this._set(n)}setValue(){super.value=this._get()}}function fe(t){return new le(t)}class ae{constructor(e){l(this,"fn");this.fn=e}}var Xe;class bt{constructor(e,n){l(this,"__v_isReadonly",!0);l(this,Xe,!0);l(this,"_cacheable",!0);l(this,"_dirty",!0);l(this,"computed");l(this,"_setter");this.computed=new ae(e),this._setter=n}get value(){return this.computed.fn()}set value(e){this._setter?this._setter(e):y("Write operation failed: computed value is readonly")}}Xe=st;function Ft(t){return typeof t=="function"?new bt(t):new bt(t.get,t.set)}const w=function(){const t=new WeakMap,e=["null","weakset","weakmap"],n={set(o){const r=new Set;for(const s of o)r.add(w(s));return r},map(o){const r=new Map;for(const[s,u]of o.entries())r.set(s,w(u));return r}};return function(o){const r=nt(o);if(typeof o!="object"||e.includes(r))return o;if(t.has(o))return t.get(o);if(n[r])return n[r](o);const s=x(o)?[]:{};Object.setPrototypeOf(s,Object.getPrototypeOf(o)),t.set(o,s);for(const u in o)s[u]=w(o[u]);return s}}();function T(t,e){return Object.assign({},t,e)}function J(t,e,n={}){let o=!1;if(o)return;const r=t();let s=w(r);return n.immediate&&e(r,void 0),P(()=>{const u=[];if(o)return u.length>0&&u.forEach(f=>f()),!0;const i=t();b(r)?n.deep&&!ot(i,s)&&(e(i,N(s)),s=w(i),Tt(i).forEach(f=>{const h=J(()=>f,()=>{e(i,N(s))},{deep:!0});u.push(h)})):i!==s&&(e(i,s),s=w(i))}),()=>{o=!0}}function Tt(t,e=[]){for(const n in t)b(t[n])&&(e.push(t[n]),Tt(t[n],e));return e}function de(t){let e=!1,n=!1;return P(()=>{if(e)return!0;t(o=>{n&&o(),n=!0})}),()=>{e=!0}}function M(t){return["string","number"].includes(typeof t)&&t!==""}function xt(t){return!/^on/.test(t)}function ut(t){return d(t)&&(G(t.tag)||I(t.tag))}function a(t){return typeof t=="function"&&!I(t)}function it(t){return[void 0,null,"",!0,!1].includes(t)}function V(t){return document.createTextNode(t)}function c(t,e,...n){const o={tag:t,attrs:e||{},children:n};return a(o.tag)&&o.children.length===0&&o.attrs.children&&(o.children=o.attrs.children),o}function L({children:t}){return t}const U=Symbol("Fragment");L.prototype[U]=U;function I(t){return typeof t=="function"&&t.prototype[U]===U}let v=!1;function Rt(t){v=t}const X=[];let Vt=!1;function vt(t){if(!v){if(Vt){m(t);return}X.push(t)}}function St(){X.forEach(t=>{t()}),X.length=0,Vt=!0}const Bt=new WeakMap;function Wt(t,e=[]){return t.forEach(n=>{d(n)&&(a(n.tag)?e.push({comp:n.tag,compId:n.tag.prototype._id,props:T(n.attrs,{children:t})}):M(n.tag)&&Wt(n.children,e))}),e}function ct(t,e=[]){const n=Bt.get(t)||[];return e.push(...n),n.forEach(o=>{const r=ct(o.comp);e.push(...r)}),e}const Z=new Map;function Dt(t,e){if(v)return;const n=t.prototype._id,o=Z.get(n)||[];o.some(s=>s===e)||(o.push(e),Z.set(n,o))}function wt(t){const e=ct(t).map(o=>o.compId);e.unshift(t.prototype._id);const n=[];e.forEach(o=>{const r=Z.get(o)||[];n.push(...r)}),n.forEach(o=>{o()})}const tt=[];let Ut=!1;function he(t){if(!v){if(Ut){t();return}tt.push(t)}}function pe(){tt.forEach(t=>{t()}),tt.length=0,Ut=!0}const et=new Map;function ge(t,e){if(v)return;const n=t.prototype._id,o=et.get(n)||[];o.some(s=>s===e)||(o.push(e),et.set(n,o))}function Et(t){const e=ct(t).map(o=>o.compId);e.unshift(t.prototype._id);const n=[];e.forEach(o=>{const r=et.get(o)||[];n.push(...r)}),n.forEach(o=>{o()})}function O(t,e,n){if(G(t))return lt(t,e,n);if(I(t))return H(n);if(a(t)){const o=T(e,{children:n});t.prototype._id=te();const r=t(o);return M(r)?V(r):(Bt.set(t,Wt(r.children)),O(r.tag,r.attrs,r.children))}}function lt(t,e={},n=[""]){if(I(t))return O(t,e,n);const o=document.createElement(t);n.forEach(r=>{if(!it(r)){if(M(r)){const s=V(r);s.nodeValue=r,o.appendChild(s);return}if(typeof r=="function"){const s=H([r]);o.appendChild(s);return}if(x(r)){const s=H(r);o.appendChild(s);return}if(ut(r)){const s=lt(r.tag,r.attrs,r.children);o.appendChild(s);return}if(d(r)&&a(r.tag)){const s=O(r.tag,r.attrs,r.children);o.appendChild(s);return}y(`render: 不支持 ${r} 值渲染`)}});for(const r in e){const s=e[r];o[r]=s,r==="ref"&&(s.value=o),typeof s=="function"&&xt(r)&&P(()=>{o[r]=s()})}if(e.style&&d(e.style))for(const r in e.style){const s=e.style[r];typeof s=="function"?P(()=>o.style[r]=s()):o.style[r]=s}return o}function H(t){const e=document.createDocumentFragment();return t.forEach(n=>{if(!it(n)){if(M(n)){const o=V(n);o.nodeValue=n,e.appendChild(o);return}if(typeof n=="function"){me(e,n);return}if(x(n)){const o=H(n);e.appendChild(o);return}if(ut(n)){const o=lt(n.tag,n.attrs,n.children);e.appendChild(o);return}if(d(n)&&a(n.tag)){const o=O(n.tag,n.attrs,n.children);e.appendChild(o);return}y(`render: 不支持 ${n} 值渲染`)}}),e}function Nt(t){if(M(t))return V(t);if(ut(t)||d(t)&&a(t.tag))return O(t.tag,t.attrs,t.children)}function me(t,e){let n=[],o=!0,r=null;const s=V("");t.appendChild(s),P(()=>{let u=e();if(u&&d(u)&&I(u.tag)){y("不支持响应式节点片段渲染");return}x(u)||(u=[u]),u=u.filter(f=>!it(f));let i=0;for(;i<u.length;){let f=u[i];const h=i,R=n.findIndex(p=>p.key===h);if(R>=0){if(ot(f,n[R].tree)){i++;continue}const p=Nt(f),S=n[R].tree;a(S.tag)&&Et(S.tag),n[R].node.parentElement.replaceChild(p,n[R].node),a(S.tag)&&wt(S.tag),n[R].tree=f,n[R].node=p}else{const p=Nt(f);if(o)t.appendChild(p);else if(n.length===0)r??(r=s.parentElement),r.insertBefore(p,s.nextSibling);else{const S=n[n.length-1].node,Jt=S.nextSibling;S.parentElement.insertBefore(p,Jt)}n.push({key:h,tree:f,node:p})}i++}if(n.length>u.length){for(let f=u.length;f<n.length;f++){const h=n[f].tree;a(h.tag)&&Et(h.tag),n[f].node.remove(),a(h.tag)&&wt(h.tag)}n.splice(u.length,n.length-u.length)}o=!1})}function ft(t,e={},n=[""]){if(I(t)){const s=T(e,{children:n}),u=t(s);return q(u)}if(a(t)){const s=T(e,{children:n}),u=t(s);return ft(u.tag,u.attrs,u.children)}let o="";for(const s in e){if(s.startsWith("on")||s==="ref")continue;let u=typeof e[s]=="function"&&xt(s)?e[s]():e[s];if(s==="className"){o+=` class=${u}`;continue}if(s==="style"&&d(u)){for(const i in u)typeof u[i]=="function"&&(u[i]=u[i]());u='"'+JSON.stringify(u).slice(1,-1).replaceAll('"',"").replaceAll(",",";")+'"'}o+=` ${s}=${u}`}const r=q(n);return`<${t}${o}>${r}</${t}>`}function q(t){let e="";return t.forEach(n=>{if(M(n)){e+=n.toString();return}if(x(n)){e+=q(n);return}if(typeof n=="function"){const o=n();e+=q([o]);return}if(d(n)){e+=ft(n.tag,n.attrs,n.children);return}y(`renderToString: 不支持 ${n} 值渲染`)}),e}function Ht({tag:t,attrs:e,children:n}){const o=O(t,e,n);if(pe(),o instanceof DocumentFragment){const r=o.children[0];m(()=>{r.parentNode&&St()})}else o instanceof HTMLElement&&m(()=>{o.parentNode&&St()});return o}function ye({tag:t,attrs:e,children:n}){Rt(!0);const o=ft(t,e,n);return Rt(!1),o}const _e=Object.freeze(Object.defineProperty({__proto__:null,Fragment:L,binding:P,computed:Ft,createSignal:Mt,customRef:fe,h:c,isProxy:re,isReactive:rt,isRef:It,markRaw:se,nextTick:m,onBeforeMount:he,onBeforeUnmount:ge,onMounted:vt,onUnmounted:Dt,reactive:N,readonly:Pt,ref:F,render:Ht,renderToString:ye,toRaw:oe,toRef:ie,toRefs:ce,unref:ue,watch:J,watchEffect:de},Symbol.toStringTag,{value:"Module"}));let _="",C,at=!0,B="";function qt(t){_=t.base||"/",/(^\/$|^\/.+\/$)/.test(_)||y("base 必须以 / 开头 / 结尾"),C=t.mode||"history",at=t.isBrowser??!0,B=t.SSR_DATA_KEY||"g_initialProps"}function dt(t){if(G(t))return t;t=t;const e=t.path;let n="";for(const s in t.query)n+=`&${s}=${t.query[s]}`;n=n?"?"+n:"";const o=t.hash?"#"+t.hash:"";return e+n+o}function be(t){const e={};return t.replace("?","").split("&").forEach(o=>{const[r,s]=o.split("=");r&&s&&(e[r]=s)}),e}function Q(t){return t.replace(/\/+/g,"/")}const A=N({path:"",query:{},hash:"",meta:{}});function j(t){const e=new URL(Q("http://0.0.0.0/"+t));A.path=e.pathname.replace(_,"/"),A.query=be(e.search),A.hash=e.hash}function Re(){if(!A.path&&at){let t="";C==="history"?t=location.href.replace(location.origin+_,""):t=location.hash.slice(1),j(t)}return A}function Se(t){const e=dt(t);C==="history"?history.pushState({},"",Q(_+"/"+e)):location.hash=e,j(e)}function we(t){const e=dt(t);C==="history"?history.replaceState({},"",Q(_+"/"+e)):location.hash=e,j(e)}function Ee(t){history.go(t)}function ht(){return{push:Se,replace:we,go:Ee}}function pt(t){const e=t.component;return c(e,null)}const Y=Symbol("Route");pt.prototype[Y]=Y;function Ot(t){return typeof t=="function"&&t.prototype[Y]===Y}function Ne(t){const e=ht();return vt(()=>{e.replace(t.to)}),c("div",null)}let Ct=!0;function Yt(t,e=!0){const n=F(null),o=F(void 0);return J(()=>A.path,async r=>{const s=t.children.filter(i=>d(i)&&Ot(i.tag)),u=s.find(i=>i.attrs.exact?r===i.attrs.path:(r+"/").startsWith(i.attrs.path+"/"));if(u)if(e){const i=u.attrs.component;typeof i.prototype.getInitialProps=="function"?Ct&&window[B]?(o.value=window[B],delete window[B],Ct=!1):(t.Loading&&(n.value=t.Loading),o.value=await i.prototype.getInitialProps()):o.value=void 0,n.value=i}else n.value=u.attrs.component;else{const i=s[s.length-1];d(i)&&Ot(i.tag)&&!i.attrs.path?n.value=i.attrs.component:n.value=null}},{immediate:!0}),{CurrentComp:n,data:o}}function Oe(t){function e(){return C==="history"?location.href.replace(location.origin+_,""):location.hash.slice(1)}j(e()),window.addEventListener("popstate",()=>{j(e())});const{CurrentComp:n,data:o}=Yt(t);return c(L,null,()=>n.value?c(n.value,{data:o.value}):null)}function Ce(t){let e="";if(C==="history")e=t.url.replace(_,"");else{const o=t.url.match(/#.*/);e=o?o[0]:""}j(e);const{CurrentComp:n}=Yt({children:t.children,url:e},!1);return c(L,null,()=>c(n.value,{data:t.data}))}function Kt(t){return c(L,null,at?c(Oe,{...t}):c(Ce,{...t}))}const ke={to:"/",type:"push"};function W(t){t=T(ke,t);const e=G(t.to)?t.to:dt(t.to),n=Q(_+(C==="hash"?"#"+e:e)),o=ht();function r(s){s.preventDefault(),t.type==="push"?o.push(e):o.replace(e)}return c("a",{href:n,onclick:r},t.children)}const Ae=Object.freeze(Object.defineProperty({__proto__:null,Link:W,Redirect:Ne,Route:pt,Router:Kt,initRouter:qt,useRoute:Re,useRouter:ht},Symbol.toStringTag,{value:"Module"}));function Pe(t,e=0){return Math.floor(Math.random()*(t-e)+e)}function je(t="000000",e="ffffff"){const n=parseInt(t,16),o=parseInt(e,16);return"#"+Pe(o,n).toString(16)}const Me="page-home-9fa45b",Le="red-font-8020a0",kt={"page-home":"page-home-9fa45b",pageHome:Me,"red-font":"red-font-8020a0",redFont:Le},K=Symbol("action");function Ie(t){return typeof t=="function"&&t.prototype[K]===K}var g;class $e{constructor(e,n){l(this,"state");l(this,"actions");yt(this,g,!0);this.state=N(w(e)),J(()=>this.state,()=>{mt(this,g)&&this._merge(e)},{deep:!0}),this.actions={};for(const o in n){let r=function(...u){k(s,g,!1);const i=n[o](...u);s._merge(e),b(i)&&i[Symbol.toStringTag]==="Promise"?i.then(()=>{s._merge(e),m(()=>k(s,g,!0))}):(s._merge(e),m(()=>k(s,g,!0)))};const s=this;r.prototype[K]=K,this.actions[o]=r}}_merge(e){const n=Object.keys(e);for(const o in e)this.state[o]=e[o];for(const o in this.state)Ie(this.state[o])||!n.includes(o)&&delete this.state[o]}get store(){k(this,g,!1);const e=Object.assign(this.state,this.actions);return m(()=>k(this,g,!0)),e}}g=new WeakMap;function Fe(t,e){return()=>new $e(t,e).store}const zt={count:0},Te={setCount(t){zt.count=t}},xe=Fe(zt,Te);function z(t){const e=xe(),n=F(0),o=F(null);return Dt(z,()=>{console.log(z.name,"组件被卸载")}),c("div",{className:kt["page-home"]},c("h1",null,"Store: ",()=>e.count),c("button",{onclick:()=>e.setCount(++e.count)},"Store change"),c("h1",{ref:o},"Ref: count ",c("span",{className:kt["red-font"]},()=>n.value)),c("button",{onclick:()=>n.value++},"count++"),c(Ve,{count:()=>n.value}),c("h1",null,"Page.getInitialProps: ",t.data))}z.prototype.getInitialProps=async()=>new Promise(t=>{setTimeout(()=>{t(123)},300)});function Ve(t){const e=Ft(()=>je().slice(0,-1)+t.count().toString().slice(0,1));return c("h1",{style:{color:()=>e.value}},"子组件 ",t.count)}const ve="page-about-d0f5f3",Be={"page-about":"page-about-d0f5f3",pageAbout:ve};function We(){return c("div",{className:Be["page-about"]},c("p",null,"自个儿手写的 Vue 响应式源码，实现个大概！"),c("strong",null,"Vue API"),c("p",null,Object.keys(_e).join("、")),c("strong",null,"Router API"),c("p",null,Object.keys(Ae).join("、")))}const De="not-found-710606",Ue={"not-found":"not-found-710606",notFound:De};function He(){return c("div",{className:Ue["not-found"]},"404")}const qe="header-937207",Ye="github-211c2b",At={header:qe,github:Ye},Ke={BASE_URL:"/",NODE_ENV:"production",BASE_API:"/api",DEPLOY_URL:"/"},ze=[{path:"/",component:z,exact:!0},{path:"/about",component:We},{component:He}];function Ge(t){return qt({base:Ke.BASE_URL,mode:"history",isBrowser:t.isBrowser}),c(L,null,c("nav",{className:At.header},c(W,{to:"/"},"首页"),c(W,{to:"/about"},"关于"),c(W,{to:"/404"},"notFound"),c("a",{className:At.github,href:"https://github.com/yubo9807/mvvm_vue3",target:"_blank"},"GitHub")),c(Kt,{url:t.url,data:t.data,Loading:Je},...ze.map(e=>c(pt,{...e}))))}function Je(){return c("div",null,"loading...")}const Gt=document.getElementById("root");Gt.innerHTML="";Gt.appendChild(Ht(c(Ge,{isBrowser:!0})));
