var lt=Object.defineProperty;var ht=(t,r,e)=>r in t?lt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var g=(t,r,e)=>(ht(t,typeof r!="symbol"?r+"":r,e),e);function B(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function m(t){return["object","array"].includes(B(t))}function dt(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function U(t,r){if(m(t)&&m(r)){const e=Object.keys(t),n=Object.keys(r);if(e.length!==n.length)return!1;for(const o of e)if(!n.includes(o)||!U(t[o],r[o]))return!1;return!0}else return t===r}function y(t){return B(t)==="object"}function I(t){return Array.isArray(t)}function $(t){return typeof t=="string"}function _(t){Promise.resolve().then(t)}function pt(){return Number(Math.random().toString().slice(2)).toString(32)}function j(...t){console.warn(...t)}let S=null;const C=new WeakMap;function P(t){S=t,t(),S=null}function gt(t){const r=C.get(t)||[],e=r.some(n=>S===n);S&&!e&&(r.push(S),C.set(t,r))}function X(t){const r=C.get(t);r&&r.forEach((e,n)=>{e()===!0&&(r.splice(n,1),C.set(t,r))})}function mt(t){C.delete(t)}const yt=new WeakMap,L=new WeakMap,V={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function K(t){if(!m(t)||Object.isFrozen(t))return j(`lue cannot be made reactive: ${t}`),t;if(yt.get(t))return t;let r=null;return new Proxy(t,{get(e,n,o){if(n===V.RAW)return e;if(m(e[n]))return K(e[n]);const c=Reflect.get(e,n,o);return gt(e),c},set(e,n,o,c){if(e[V.IS_READONLY])return!0;if(m(e[n])){const f=e[n],a=new Set;for(const l in o)a.add(l),this.set(f,l,o[l],c[n]);for(const l in f)a.has(l)||this.deleteProperty(f,l);return!0}if(Reflect.get(e,n,c)===o)return!0;const i=Reflect.set(e,n,o,c),u=L.get(e)||new Set;u.add(n);const d=u.size;return L.set(e,u),_(()=>{const f=Reflect.get(e,n,c);i&&f===o&&d===1&&X(e),L.delete(e)}),i},deleteProperty(e,n){const o=Reflect.get(e,n);if(m(o)){for(const i in o)this.deleteProperty(o,i);return!0}const c=dt(e,n),s=Reflect.deleteProperty(e,n);return r=n,_(()=>{c&&s&&o!==void 0&&n===r&&(X(e),r=null)}),s}})}function bt(t){return!!t[V.RAW]}function wt(t){return bt(t)?t[V.RAW]:t}function Rt(t){const r=K({value:t});function e(){return r.value}function n(o){r.value=o}return[e,n]}const St="__v_isRef";var Dt;class Et{constructor(r){g(this,Dt,!0);g(this,"__v_isShallow",!1);g(this,"_rawValue");g(this,"_value");g(this,"getSignal");g(this,"setSignal");this._rawValue=r;const[e,n]=Rt(r);this.getSignal=e,this.setSignal=n,this._value=e()}get value(){return this.getSignal()}set value(r){this.setSignal(r),this._rawValue=r}}Dt=St;function _t(t){return new Et(t)}const E=function(){const t=new WeakMap,r=["null","weakset","weakmap"],e={set(n){const o=new Set;for(const c of n)o.add(E(c));return o},map(n){const o=new Map;for(const[c,s]of n.entries())o.set(c,E(s));return o}};return function(n){const o=B(n);if(typeof n!="object"||r.includes(o))return n;if(t.has(n))return t.get(n);if(e[o])return e[o](n);const c=I(n)?[]:{};Object.setPrototypeOf(c,Object.getPrototypeOf(n)),t.set(n,c);for(const s in n)c[s]=E(n[s]);return c}}();function D(t,r){return Object.assign({},t,r)}function Ct(t,r,e={}){let n=!1;if(n)return;const o=t();e.immediate&&r(o,void 0);let c=E(o),s=!0;return P(()=>{const i=t();if(m(i)){e.deep&&!U(i,c)&&(r(i,c),c=E(i));return}if(s){s=!1;return}i!==c&&(r(i,c),c=i)}),()=>{n=!0}}function T(t){return["string","number"].includes(typeof t)&&t!==""}function Mt(t){return!/^on/.test(t)}function z(t){return y(t)&&($(t.tag)||O(t.tag))}function h(t){return typeof t=="function"&&!O(t)}function Y(t){return[void 0,null,"",!0,!1].includes(t)}function N(t){return document.createTextNode(t)}function b(t,r,...e){const n={tag:t,attrs:r||{},children:e};return h(n.tag)&&n.children.length===0&&n.attrs.children&&(n.children=n.attrs.children),n}function ot({children:t}){return t}const F=Symbol("Fragment");ot.prototype[F]=F;function O(t){return typeof t=="function"&&t.prototype[F]===F}const q=[];let ct=!1;function qt(t){if(ct){_(t);return}q.push(t)}function Z(){q.forEach(t=>{t()}),q.length=0,ct=!0}const st=new WeakMap;function it(t,r=[]){return t.forEach(e=>{y(e)&&(h(e.tag)?r.push({comp:e.tag,compId:e.tag.prototype._id,props:D(e.attrs,{children:t})}):T(e.tag)&&it(e.children,r))}),r}function H(t,r=[]){const e=st.get(t)||[];return r.push(...e),e.forEach(n=>{const o=H(n.comp);r.push(...o)}),r}const jt=new Map;function v(t){const r=H(t).map(n=>n.compId);r.unshift(t.prototype._id);const e=[];r.forEach(n=>{const o=jt.get(n)||[];e.push(...o)}),e.forEach(n=>{n()})}const tt=[];function Tt(){tt.forEach(t=>{t()}),tt.length=0}const Nt=new Map;function et(t){const r=H(t).map(n=>n.compId);r.unshift(t.prototype._id);const e=[];r.forEach(n=>{const o=Nt.get(n)||[];e.push(...o)}),e.forEach(n=>{n()})}function w(t,r,e){if($(t))return Q(t,r,e);if(O(t))return W(e);if(h(t)){const n=D(r,{children:e});t.prototype._id=pt();const o=t(n);return T(o)?N(o):(st.set(t,it(o.children)),w(o.tag,o.attrs,o.children))}}function Q(t,r={},e=[""]){if(O(t))return w(t,r,e);const n=document.createElement(t);e.forEach(o=>{if(!Y(o)){if(T(o)){const c=N(o);c.nodeValue=o,n.appendChild(c);return}if(typeof o=="function"){const c=W([o]);n.appendChild(c);return}if(I(o)){const c=W(o);n.appendChild(c);return}if(z(o)){const c=Q(o.tag,o.attrs,o.children);n.appendChild(c);return}if(y(o)&&h(o.tag)){const c=w(o.tag,o.attrs,o.children);n.appendChild(c);return}j(`render: 不支持 ${o} 值渲染`)}});for(const o in r){const c=r[o];n[o]=c,o==="ref"&&(c.value=n),typeof c=="function"&&Mt(o)&&P(()=>{n[o]=c()})}if(r.style&&y(r.style))for(const o in r.style){const c=r.style[o];typeof c=="function"?P(()=>n.style[o]=c()):n.style[o]=c}return n}function W(t){const r=document.createDocumentFragment();return t.forEach(e=>{if(!Y(e)){if(T(e)){const n=N(e);n.nodeValue=e,r.appendChild(n);return}if(typeof e=="function"){Ot(r,e);return}if(I(e)){const n=W(e);r.appendChild(n);return}if(z(e)){const n=Q(e.tag,e.attrs,e.children);r.appendChild(n);return}if(y(e)&&h(e.tag)){const n=w(e.tag,e.attrs,e.children);r.appendChild(n);return}j(`render: 不支持 ${e} 值渲染`)}}),r}function nt(t){if(T(t))return N(t);if(z(t)||y(t)&&h(t.tag))return w(t.tag,t.attrs,t.children)}function Ot(t,r){let e=[],n=!0,o=null;const c=N("");t.appendChild(c),P(()=>{let s=r();if(s&&y(s)&&O(s.tag)){j("不支持响应式节点片段渲染");return}I(s)||(s=[s]),s=s.filter(u=>!Y(u));let i=0;for(;i<s.length;){let u=s[i];const d=i,f=e.findIndex(a=>a.key===d);if(f>=0){if(U(u,e[f].tree)){i++;continue}const a=nt(u);if(!a){s.splice(f,1),i++;continue}const l=e[f].tree;h(l.tag)&&et(l.tag),e[f].node.parentElement.replaceChild(a,e[f].node),h(l.tag)&&v(l.tag),e[f].tree=u,e[f].node=a}else{const a=nt(u);if(!a){i++;continue}if(n)t.appendChild(a);else if(e.length===0)o??(o=c.parentElement),o.insertBefore(a,c.nextSibling);else{const l=e[e.length-1].node,at=l.nextSibling;l.parentElement.insertBefore(a,at)}e.push({key:d,tree:u,node:a})}i++}if(e.length>s.length){for(let u=s.length;u<e.length;u++){const d=e[u].tree;h(d.tag)&&et(d.tag),e[u].node.remove(),h(d.tag)&&v(d.tag)}e.splice(s.length,e.length-s.length)}n=!1})}function Bt({tag:t,attrs:r,children:e}){const n=w(t,r,e);if(Tt(),n instanceof DocumentFragment){const o=n.children[0];_(()=>{o.parentNode&&Z()})}else n instanceof HTMLElement&&_(()=>{n.parentNode&&Z()});return n}let p="",R,ut=!0;function Ut(t){p=t.base||"/",/(^\/$|^\/.+\/$)/.test(p)||j("base 必须以 / 开头 / 结尾"),R=t.mode||"history",ut=t.isBrowser??!0,t.SSR_DATA_KEY}function G(t){if($(t))return t;t=t;const r=t.path;let e="";for(const c in t.query)e+=`&${c}=${t.query[c]}`;e=e?"?"+e:"";const n=t.hash?"#"+t.hash:"";return r+e+n}function At(t){const r={};return t.replace("?","").split("&").forEach(n=>{const[o,c]=n.split("=");o&&c&&(r[o]=c)}),r}function A(t){return t.replace(/\/+/g,"/")}const k=K({path:"",query:{},hash:"",meta:{}});function M(t){const r=new URL(A("http://0.0.0.0/"+t));k.path=r.pathname.replace(p,"/"),k.query=At(r.search),k.hash=r.hash}function kt(t){const r=G(t);R==="history"?history.pushState({},"",A(p+"/"+r)):location.hash=r,M(r)}function Pt(t){const r=G(t);R==="history"?history.replaceState({},"",A(p+"/"+r)):location.hash=r,M(r)}function Vt(t){history.go(t)}function Ft(){return{push:kt,replace:Pt,go:Vt}}function Wt(t){t.exact??(t.exact=!0);const r=t.component;return b(r,null)}const x=Symbol("Route");Wt.prototype[x]=x;function rt(t){return typeof t=="function"&&t.prototype[x]===x}function J(t,r){const e=t.find(c=>c.attrs.exact||c.attrs.exact===void 0?r===c.attrs.path:(r+"/").startsWith(A(c.attrs.path+"/")));if(!e)return null;const n={tag:"",attrs:{},children:[]};n.tag=e.attrs.component;const o=[J(e.children,r)].filter(c=>c);if(n.children=o,o.length===0){const c=e.children[e.children.length-1];c&&rt(c.tag)&&!c.attrs.path&&(n.children=[D(n,{tag:c.attrs.component})])}if(e.attrs.exact===!1&&n.children.length===0){const c=t[t.length-1];if(c&&rt(c.tag)&&!c.attrs.path)return n.tag=c.attrs.component,n}return n}function ft(t,r=[]){const{tag:e,attrs:n,children:o}=t;return r.push({tag:e,attrs:n,children:[]}),o.length>0&&ft(o[0],r),r}function xt(t){const r=function(){return R==="history"?()=>location.href.replace(location.origin+p,""):()=>location.hash.slice(1)}();M(r()),window.addEventListener("popstate",()=>{M(r())});const e=_t([]);Ct(()=>k.path,c=>{const s=J(t.children,c);e.value=ft(s)},{immediate:!0});const n=new Array;function o(c=0){return()=>{const s=e.value[c];if(!s)return delete n[c],null;const i=wt(s);return c>0&&n[c]&&!i.tag&&mt(n[c]),n[c]=i,b(s.tag,null,o(c+1))}}return b(ot,null,o())}function It(t){let r="";if(R==="history")r=t.url.replace(p,"");else{const n=t.url.match(/#.*/);r=n?n[0]:""}M(r);const e=J(t.children,r);return b(e.tag,{children:e.children})}function Kt(t){return ut?b(xt,{...t}):b(It,{...t})}const $t={to:"/",type:"push"};function zt(t){t=D($t,t);const r=$(t.to)?t.to:G(t.to),e=A(p+(R==="hash"?"#"+r:r)),n=Ft();function o(c){c.preventDefault(),t.type==="push"?n.push(r):n.replace(r)}return b("a",{href:e,onclick:o},t.children)}export{zt as L,Kt as R,Wt as a,Bt as b,b as h,Ut as i,qt as o,K as r};
