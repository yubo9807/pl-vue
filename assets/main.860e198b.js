(()=>{"use strict";function e(e,t,...n){return{tag:e,attrs:t||{},children:n}}function t({children:e}){return e}const n=Symbol("Fragment");function r(e){return"function"==typeof e&&e.prototype[n]===n}function o(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function c(e){return"object"==typeof e}function l(e,t){if("object"==typeof e&&"object"==typeof t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n){if(!r.includes(o))return!1;if(!l(e[o],t[o]))return!1}return!0}return e===t}function i(e){return["string","number"].includes(typeof e)&&""!==e}function u(e){return["className","innerHTML","innerText","textContent"].includes(e)}function s(e){return"object"===o(e)&&("string"==typeof e.tag||r(e.tag))}t.prototype[n]=n;let a=null;const f=new WeakMap;function d(e){a=e,e(),a=null}function p(e){const t=f.get(e);t&&t.forEach(((n,r)=>{const o=n();"boolean"==typeof o&&o&&(t.splice(r,1),f.set(e,t))}))}const h=new WeakMap,y={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function g(e){return!c(e)||h.get(e)?e:new Proxy(e,{get(e,t,n){if(t===y.RAW)return e;!function(e){const t=f.get(e)||[];a&&t.push(a),f.set(e,t)}(e);const r=Reflect.get(e,t,n);return c(r)?g(r):r},set(e,t,n,r){const o=Reflect.get(e,t,r),c=Reflect.set(e,t,n,r);return e[y.IS_READONLY]?o:(c&&o!==n&&p(e),c)},deleteProperty(e,t){const n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t),r=Reflect.deleteProperty(e,t);return n&&r&&p(e),r}})}class _{__v_isRef=!0;__v_isShallow=!1;_rawValue;_value;constructor(e){this._rawValue=e,this._value=c(e)?g(e):g({value:e})}get value(){return c(this._rawValue)?this._value:this._value.value}set value(e){this._rawValue=e,c(e)?this._value=e:this._value.value=e}}function b(e){return e instanceof Array?function(e){let t=new Array(e.length);for(let n=0;n<t.length;n++)t[n]=b(e[n]);return t}(e):"object"===o(e)?function(e){let t={},n=Object.getOwnPropertyNames(e);for(let r=0;r<n.length;r++)t[n[r]]=b(e[n[r]]);return t}(e):e}function m(e,t={},n=[]){if("function"==typeof e&&!r(e)){const r=e(b(Object.assign({},t,{children:n})));return m(r.tag,r.attrs,r.children)}const c=[];return n.forEach((e=>{if("object"===o(e)){const t=m(e.tag,e.attrs,e.children);c.push(t)}else c.push(e)})),{tag:e,attrs:t,children:c}}function v(e,t,n){return"string"==typeof e?w(e,t,n):r(e)?j(n):void 0}function w(e,t={},n=[""]){if(r(e))return v(e,t,n);const o=document.createElement(e);n.forEach((e=>{if(i(e)){const t=document.createTextNode(e);return t.nodeValue=e,void o.appendChild(t)}if("function"!=typeof e)if(e instanceof Array){const t=j(e);o.appendChild(t)}else if(s(e)){const t=w(e.tag,e.attrs,e.children);o.appendChild(t)}else console.warn(`render: 不支持 ${e} 值渲染`);else{const t=j([e]);o.appendChild(t)}}));for(const e in t){const n=t[e];o[e]=n,"function"==typeof n&&u(e)&&d((()=>{o[e]=n()}))}if(t.style&&t.style instanceof Object)for(const e in t.style){const n=t.style[e];"function"==typeof n?d((()=>o.style[e]=n())):o.style[e]=n}return o}function j(e){const t=document.createDocumentFragment();return e.forEach((e=>{if(i(e)){const n=document.createTextNode(e);return n.nodeValue=e,void t.appendChild(n)}if("function"!=typeof e)if(e instanceof Array){const n=j(e);t.appendChild(n)}else if(s(e)){const n=w(e.tag,e.attrs,e.children);t.appendChild(n)}else console.warn(`render: 不支持 ${e} 值渲染`);else{let n=[],r=0;d((()=>{let c=e();if(c instanceof Array||(c=[c]),c=c.filter((e=>e)),c.forEach(((e,c)=>{const u=c,s=n.findIndex((e=>e.key===u));if(s>=0){if(l(e,n[s].tree))return;let t=null;i(e)?t=document.createTextNode(e.toString()):"object"===o(e)&&(t=v(e.tag,e.attrs,e.children)),n[s].node.parentElement.replaceChild(t,n[s].node),n[s].tree=e,n[s].node=t}else{let c=null;if(i(e)?c=document.createTextNode(e.toString()):"object"===o(e)&&(c=v(e.tag,e.attrs,e.children)),0===r)t.appendChild(c);else{const e=n[n.length-1].node,t=e.nextSibling;e.parentElement.insertBefore(c,t)}n.push({key:u,tree:e,node:c})}})),n.length>c.length)for(let e=c.length;e<n.length;e++)n[e].node.remove();r++}))}})),t}const C="demo__bac49";function E(t){return e("div",null,e("p",null,"子组件"),e("p",null,"props: ",t.count),e("p",null,t.children))}document.getElementById("root").appendChild(function({tag:e,attrs:t,children:n}){const r=m(e,t,n);return v(r.tag,r.attrs,r.children)}(e((function(){const n=new _(1);return e(t,null,"父组件",e("h1",{className:C},(()=>n.value)),e(E,{count:()=>n.value},e("p",null,"插槽1"),e("p",null,"插槽2")),e("button",{onclick:()=>n.value++},"click"))}),null)))})();