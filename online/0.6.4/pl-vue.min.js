function t(...t){console.warn(...t)}function e(t){return t.length}function n(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function r(t){return["object","array"].includes(n(t))}function o(t,n){if(r(t)&&r(n)){const r=Object.keys(t),i=Object.keys(n);if(e(r)!==e(i))return!1;for(const e of r){if(!i.includes(e))return!1;if(!o(t[e],n[e]))return!1}return!0}return t===n}function i(t){return"object"===n(t)}function s(t){return Array.isArray(t)}function c(t){return"string"==typeof t}function u(t){return"function"==typeof t}function l(t){Promise.resolve().then(t)}class a extends WeakMap{}function f(t,e={}){const r=new a,o=["null","regexp","date","weakset","weakmap"],i=Object.assign({function(t){const e=function(...e){return t.apply(this,e)};return e.prototype=c(t.prototype),e},set(t){const e=new Set;for(const n of t)e.add(c(n));return e},map(t){const e=new Map;for(const[n,r]of t.entries())e.set(n,c(r));return e}},e);function c(t){if("object"==typeof window&&t instanceof HTMLElement)return t.cloneNode(!0);const e=n(t);if(!["object","function"].includes(typeof t)||o.includes(e))return t;if(r.has(t))return r.get(t);if(i[e])return i[e](t);const u=s(t)?[]:{};Object.setPrototypeOf(u,Object.getPrototypeOf(t)),r.set(t,u);for(const e in t)t.hasOwnProperty(e)&&(u[e]=c(t[e]));return u}return c(t)}function d(t,e){return Object.assign({},t,e)}function h(t,e,n){let r=0;for(;r<t.length;){if(t.hasOwnProperty(r)){const o=t[r];e.apply(n,[o,r,n])}r++}}let p=null;const g=new a;function y(t){p=t,t(),p=null}function m(t){const e=g.get(t);e&&h(e,((n,r)=>{!0===n()&&(e.splice(r,1),g.set(t,e))}))}function _(...t){h(t,(function t(e){const n=M(e);for(const e in n){const o=n[e];r(o)&&t(o)}g.delete(n)}))}function v(e){return Reflect.defineProperty(e,b.IS_READONLY,{value:!0}),new Proxy(e,{get:(t,e)=>e===b.RAW?t:Reflect.get(t,e),set(e,n,r){const o=Reflect.get(e,n);return t(`Set operation on key '${n.toString()}' failed: target is readonly.`,{[n.toString()]:o}),o},deleteProperty(e,n){const r=Reflect.get(e,n);return t(`Delete operation on key '${n.toString()}' failed: target is readonly.`,{[n.toString()]:r}),r}})}const w=new a,S=new a,b={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function R(e){if(!r(e)||Object.isFrozen(e))return t(`lue cannot be made reactive: ${e}`),e;if(w.get(e))return e;let n=null;return new Proxy(e,{get(t,e,n){if(e===b.RAW)return t;const o=Reflect.get(t,e,n);return function(t){const e=g.get(t)||[],n=e.some((t=>p===t));p&&!n&&(e.push(p),g.set(t,e))}(t),r(o)?R(o):o},set(t,e,n,r){if(t[b.IS_READONLY])return!0;if(Reflect.get(t,e,r)===n)return!0;const o=Reflect.set(t,e,n,r),i=S.get(t)||new Set;i.add(e);const s=i.size;return S.set(t,i),l((()=>{o&&1===s&&m(t),S.delete(t)})),o},deleteProperty(t,e){const r=Reflect.get(t,e),o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,e),i=Reflect.deleteProperty(t,e);return n=e,l((()=>{o&&i&&void 0!==r&&e===n&&(m(t),n=null)})),i}})}function N(t){return i(t)&&!!t[b.RAW]}function M(t){return N(t)?t[b.RAW]:t}function O(t){return N(t)||function(t){return t&&v(t)[b.IS_READONLY]}(t)}function j(t){return r(t)&&w.set(t,!0),t}function L(t){const e={value:t},n=R(e);return[function(){return n.value},function(t){n.value=t},e]}const T=Symbol("__v_isRef");class k{[T]=!0;_rawValue;_value;getSignal;setSignal;constructor(t){const[e,n,r]=L(t);this._rawValue=r,this.getSignal=e,this.setSignal=n,this._value=e()}get value(){return this.getSignal()}set value(t){this.setSignal(t)}}function x(t=void 0){return new k(t)}function A(t){return t&&!!t[T]}function F(t){return A(t)?t.value:t}class E{[T]=!0;_defaultValue;_key;_object;constructor(t,e,n=void 0){this._defaultValue=n,this._key=e,this._object=t}get value(){return this._object[this._key]}set value(t){this._object[this._key]=t}}function H(t,e,n=void 0){return new E(t,e,n)}function P(t){const e={};for(const n in t)e[n]=new E(t,n);return e}class $ extends k{_get;_set;constructor(t){let e=!1;const{get:n,set:r}=t((()=>e=!0),(()=>this.setValue()));super(n()),this[T]=e,this._get=n,this._set=r}get value(){return this[T]?super.value:this._get()}set value(t){this._set(t)}setValue(){super.value=this._get()}}function W(t){return new $(t)}class C{fn;constructor(t){this.fn=t}}class D{__v_isReadonly=!0;[T]=!0;_cacheable=!0;_dirty=!0;computed;_setter;constructor(t,e){this.computed=new C(t),this._setter=e}get value(){return this.computed.fn()}set value(e){this._setter?this._setter(e):t("Write operation failed: computed value is readonly")}}function V(t){return u(t)?new D(t):new D(t.get,t.set)}function I(t,e,n={}){let i=!1;if(i)return;const s=t();n.immediate&&e(s,void 0);let c=f(s),u=!0;return y((()=>{if(i)return!0;const s=t();r(s)?n.deep&&!o(s,c)&&(e(s,c),c=f(s)):u?u=!1:s!==c&&(e(s,c),c=s)})),()=>{i=!0}}function Y(t){let e=!1,n=!1;return y((()=>{if(e)return!0;t((t=>{n&&t(),n=!0}))})),()=>{e=!0}}function z(t){return["string","number"].includes(typeof t)&&""!==t}function B(t){return!/^on/.test(t)}function J(t){return u(t)&&!et(t)}function q(t){return function(t){return"class"===t.toString().slice(0,5)}(t)&&t.prototype&&t.prototype.render}function G(t){return[void 0,null,"",!0,!1].includes(t)}function K(...t){return t.filter((t=>z(t))).join(" ").trim().replace(/\s+/," ")}function Q(t){return document.createTextNode(t)}function U(t,e){t.appendChild(e)}function X(t,n,...r){const o={tag:t,attrs:n||{},children:r};return J(o.tag)&&0===e(o.children)&&o.attrs.children&&(o.children=o.attrs.children),o}function Z({children:t}){return t}const tt=Symbol("Fragment");function et(t){return u(t)&&t.prototype&&t.prototype[tt]===tt}Z.prototype[tt]=tt;const nt=new a;function rt(t,e=[]){return h(t,(n=>{i(n)&&(J(n.tag)?(e.push({comp:n.tag,props:d(n.attrs,{children:t})}),h(n.children,(t=>{J(t)&&e.push({comp:t,props:{}})}))):z(n.tag)&&rt(n.children,e))})),e}function ot(t,e=[]){const n=nt.get(t)||[];return e.push(...n),h(n,(t=>{const n=ot(t.comp);e.push(...n)})),e}let it=null;let st=null;function ct(t){st=t}let ut=!1;function lt(t){ut=t}const at=[];let ft=!1;function dt(t){ut||(ft?t():at.push(t))}const ht=[];let pt=!1;function gt(t){ut||(pt?l(t):ht.push(t))}function yt(){h(ht,(t=>t())),ht.length=0,pt=!0}const mt=new a;function _t(t){if(ut)return;const e=mt.get(it)||[],n=e.some((e=>e===t));n||(e.push(t),mt.set(it,e))}function vt(t){const e=ot(t).map((t=>t.comp));e.unshift(t);const n=[];h(e,(t=>{const e=mt.get(t)||[];n.push(...e),mt.delete(t)})),h(n,(t=>t()))}const wt=new a;function St(t){if(ut)return;const e=wt.get(it)||[],n=e.some((e=>e===t));n||(e.push(t),wt.set(it,e))}function bt(t){const e=ot(t).map((t=>t.comp));e.unshift(t);const n=[];h(e,(t=>{const e=wt.get(t)||[];n.push(...e),wt.delete(t)})),h(n,(t=>t()))}class Rt{config;constructor(t){this.config=t}intercept(t){return t}renderToString(t){lt(!0);const e=this.createHTML(t);return lt(!1),e}createHTML(t){const{tag:e,attrs:n,children:r}=this.intercept(t);if(et(e)){const t=e(d(n,{children:r}));return this.createHTMLFragment(t)}if(J(e)){if(q(e)){const t=new e({...n,children:r});return this.createHTML(t.render.bind(t))}const t=e(d(n,{children:r}));return this.createHTML(t)}let o="";for(const t in n){if(t.startsWith("on")||["ref","created"].includes(t))continue;let s=u(n[t])&&B(t)?n[t]():n[t];if(c(e)&&["innerHTML","innerText","textContent"].includes(t))r[0]=s;else if("className"!==t){if("style"===t&&i(s)){for(const t in s)u(s[t])&&(s[t]=s[t]());s='"'+JSON.stringify(s).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}o+=` ${t}="${s}"`}else s&&(o+=` class="${K(...[s].flat())}"`)}return`<${e}${o}>${this.createHTMLFragment(r)}</${e}>`}createHTMLFragment(e){let n="";return h(e,(e=>{if(z(e))n+=e.toString();else if(s(e))n+=this.createHTMLFragment(e);else if(u(e)){const t=e();n+=this.createHTMLFragment([t])}else i(e)?n+=this.createHTML(e):t(`renderToString: 不支持 ${e} 值渲染`)})),n}}class Nt extends Rt{constructor(t){super(t)}render(t){const e=this.createElement(t);return h(at,(t=>t())),at.length=0,ft=!0,l(yt),e}createElement(t){const{tag:e,attrs:n,children:r}=this.intercept(t);return c(e)?this.createRealNode(e,n,r):et(e)?this.createNodeFragment(r):J(e)?this.createComponent(e,n,r):void 0}createComponent(t,e,n){if(it=t,q(t)){const r=new t({...e,children:n});t=r.render.bind(r)}const r=t(d(e,{children:n}));return function(t,e){it=t,"ref"in e&&(e.ref.value=st),st=null}(t,e),z(r)?Q(r):(nt.set(t,rt([r,...r.children])),this.createElement(r))}createRealNode(t,e={},n=[""]){const r=document.createElement(t);h(n,(t=>{if(this.intercept(t),u(t)){const e=this.createNodeFragment([t]);U(r,e)}else this.#t(r,t)}));for(const t in e)this.#e(r,t,e[t]);if(e.style&&i(e.style))for(const t in e.style){const n=e.style[t];u(n)?y((()=>r.style[t]=n())):r.style[t]=n}return r}createNodeFragment(t){const e=document.createDocumentFragment();return h(t,(t=>{this.intercept(t),u(t)?this.#n(e,t):this.#t(e,t)})),e}#t(e,n){if(!G(n))if(s(n)){U(e,this.createNodeFragment(n))}else if(z(n)||i(n)){U(e,this.createNode(n))}else t(`render: 不支持 ${n} 值渲染`)}createNode(t){return z(t)?Q(t):i(e=t)&&c(e.tag)?this.createRealNode(t.tag,t.attrs,t.children):et(t.tag)?this.createNodeFragment(t.children):J(t.tag)?this.createComponent(t.tag,t.attrs,t.children):void 0;var e}#e(t,e,n){if("ref"===e&&i(n))return void(n.value=t);if("created"===e&&u(n))return void n(t);let r=n=>t[e]=n;"className"===e?r=n=>t[e]=K(...[n].flat()):e.startsWith("data-")&&(r=n=>t.dataset[e.slice(5)]=n),B(e)&&u(n)?y((()=>r(n()))):r(n)}#n(n,r){let c=[],u=!0,l=null;const a=Q("");U(n,a),y((()=>{let f=r();if(f&&i(f)&&et(f.tag))return void t("不支持响应式节点片段渲染");s(f)||(f=[f]),f=f.filter((t=>!G(t)));let d=0;for(;d<e(f);){let t=f[d];const r=Mt(c,d);if(r>=0){if(o(t,c[r].tree)){d++;continue}const e=this.createNode(t);if(!e){f.splice(r,1),d++;continue}const n=c[r].tree;if(J(n.tag)&&vt(n.tag),c[r].node.parentElement.replaceChild(e,c[r].node),J(n.tag)){const t=n.tag;bt(t),nt.delete(t)}c[r].tree=t,c[r].node=e}else{const r=this.createNode(t);if(!r){d++;continue}if(u)U(n,r);else if(0===e(c))l??=a.parentElement,l.insertBefore(r,a.nextSibling);else{const t=c[e(c)-1].node,n=t.nextSibling;t.parentElement.insertBefore(r,n)}c.push({key:d,tree:t,node:r})}d++}if(e(c)>e(f)){for(let t=e(f);t<e(c);t++){const e=c[t].tree;if(J(e.tag)&&vt(e.tag),c[t].node.remove(),J(e.tag)){const t=e.tag;bt(t),nt.delete(t)}}c.splice(e(f),e(c)-e(f))}u=!1}))}}function Mt(t,n){let r=0,o=e(t)-1;for(;r<=o;){const e=Math.ceil((r+o)/2),i=t[e];if(n===i.key)return e;n<i.key?o=e-1:n>i.key&&(r=e+1)}return-1}class Ot extends Nt{constructor(t){super(t),this.config=t}use(t){return t.install(this),this}version="0.6.4";intercept(t){if(t&&c(t.tag)){const e=this.#r.get(t.tag);e&&(t.tag=e)}return t}#r=new Map;component(t,e){return this.#r.set(t,e),this}}function jt(t={}){return new Ot(t)}function Lt(t){return(new Nt).render(t)}function Tt(t){return(new Rt).renderToString(t)}function kt(t,e){return Lt(X(t,e))}export{Z as Fragment,k as RefImpl,y as binding,V as computed,jt as createApp,L as createSignal,W as customRef,ct as defineExpose,X as h,O as isProxy,N as isReactive,A as isRef,K as joinClass,j as markRaw,l as nextTick,dt as onBeforeMount,_t as onBeforeUnmount,gt as onMounted,St as onUnmounted,R as reactive,v as readonly,_ as recycleDepend,x as ref,Lt as render,Tt as renderToString,M as toRaw,H as toRef,P as toRefs,F as unref,kt as useComponent,I as watch,Y as watchEffect};
